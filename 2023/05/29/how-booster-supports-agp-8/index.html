<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Johnson's personal blog"><meta name="baidu-site-verification" content="sSd2p2uQfO"><meta name="keywords" content="李景森,架构设计,滴滴,快手,性能优化,我在滴滴做架构,johnsonlee,johnson,lijingsen,jingsen,booster,virtualapk,android,java,kotlin,performance,optimizer,flutter,javascript,typescript,node.js"><title>Booster 如何适配 AGP 8.0？ | Johnson Lee</title><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300"><link rel="stylesheet" type="text/css" href="/css/style.css"><link rel="preload" type="text/css" href="/libs/pure/1.0.0/pure-min.css" as="style" onload="this.rel=&quot;stylesheet&quot;"><link rel="preload" type="text/css" href="/libs/pure/1.0.0/grids-responsive-min.css" as="style" onload="this.rel=&quot;stylesheet&quot;"><link rel="preload" href="/libs/font-awesome/4.7.0/css/font-awesome.min.css" as="style" onload="this.rel=&quot;stylesheet&quot;"><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script type="text/javascript" src="/libs/loadCSS/2.1.0/loadCSS.js" async></script><script>function load() {
  return Promise.all(Array.prototype.map.call(arguments, (src) => {
    return new Promise((resolve, reject) => {
      var script = document.createElement("script");
      script.asrc = 1;
      script.src = src;
      var sibling = document.getElementsByTagName("script")[0];
      sibling.parentNode.insertBefore(script, sibling);
      script.onload = function() {
        resolve();
      }
    })
  }));
}
String.prototype.replaceAll = function(search, replacement) {
  var target = this;
  return target.split(search).join(replacement);
};</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Booster 如何适配 AGP 8.0？</h1><a id="logo" href="/.">Johnson Lee</a><p class="description">Get into trouble, make mistakes, fight, love, live</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/tags/"><i class="fa fa-tag"> 标签</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Booster 如何适配 AGP 8.0？</h1><div class="post-meta">May 29, 2023<span> | </span><span class="category"><a href="/categories/computer-science/">Computer Science</a><a href="/categories/computer-science/open-source/"> / Open Source</a><a href="/categories/computer-science/open-source/booster/"> / Booster</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1.8k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 7</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="post-content"><p>自 AGP 8.0 正式版本发布以来已经一个多月了，Booster 适配 AGP 8.0 还在持续进行中，主要是 AGP 8.0 删除了很多之前只是 deprecated 的 API，包括部分 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.2/com/android/build/api/transform/Transform">Transform API</a>，而且 <a target="_blank" rel="noopener" href="https://android.googlesource.com/platform/tools/base/+/a714ecedfa729cec69b2198bc3446149db44eaab/build-system/gradle-core/src/main/java/com/android/build/gradle/api/BaseVariant.java">Legacy Variant API</a> 也即将删除，取而代之的是 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/8.0/com/android/build/api/instrumentation/package-summary">Instrumentation API</a>、<a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/8.0/com/android/build/api/artifact/Artifacts">Artifacts API</a> 和 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/8.0/com/android/build/api/variant/package-summary">New Variant API</a>，虽然新的 API 从 AGP 7.0 开始就已经出现，但是这些新的 API 从 AGP 7.0 到 AGP 7.4 都一直在改，并没有完全稳定下来，加上跟以前的 API 完全不兼容，我们也不确定最终稳定下来会是什么样子，加上 Booster 已经支持了从 AGP 3.3 到 AGP 7.4 的 12 个版本，贸然变动 API，对于 Booster 的使用者来说，迁移也是一项非常有挑战性的事情，看到 AGP 8.0 终于删除了之前标记为废弃的 API，我们认为它的 API 也稳定下来了，是时候干一票大的了。</p>
<h2 id="AGP-为什么要废弃-Legacy-API"><a href="#AGP-为什么要废弃-Legacy-API" class="headerlink" title="AGP 为什么要废弃 Legacy API"></a>AGP 为什么要废弃 Legacy API</h2><p>先说结论，为了更丝滑的构建体验。那为什么老的 API 就不配拥有更丝滑的构建体验，而新的 API 就可以呢？</p>
<h3 id="冗余的-Transform"><a href="#冗余的-Transform" class="headerlink" title="冗余的 Transform"></a>冗余的 Transform</h3><p>这里就不得不提一下 Gradle，AGP 的整个构建都是基于 Gradle 的，早在 2015 年 AGP 1.5 正式发布 Transform API 的时候，Gradle 的版本还是 2.x，相比现在的 Gradle 8.x 简直是弱爆了，连一个像样的 Transform API 也没有，就连 <a target="_blank" rel="noopener" href="https://docs.gradle.org/3.4/javadoc/org/gradle/api/artifacts/transform/ArtifactTransform.html">ArtifactTransform</a> 也是 3.4 才有的，所以那个时候，AGP 不得不自己实现一套 Transform API 来解决 Android 应用构建过程中处理字节码的问题。然而，随着 AGP 不断的优化其构建性能，终于在 2019 年 <a target="_blank" rel="noopener" href="https://docs.gradle.org/5.3/release-notes.html">Gradle 5.3</a> 发布了 <a target="_blank" rel="noopener" href="https://docs.gradle.org/5.3/javadoc/org/gradle/api/artifacts/transform/TransformAction.html">TransformAction</a>，主要是为了解决工程中的依赖包的 transform 问题，同时，为后续的 <a target="_blank" rel="noopener" href="https://blog.gradle.org/introducing-configuration-caching">Configuration Cache</a> 提供支持。</p>
<p>在 AGP 的 Transform Pipeline 中，并没有把工程的依赖和工程自身的 classes 严格的分开，而是在一起整体处理的，这样，就会与 Gradle 自身的 dependency transform 冗余了，为了最大限度的优化 Android 应用的构建，我相信 AGP 团队也是做了相应的取舍，尽可能复用 Gradle 的 transform 而避免重复的 I&#x2F;O，这也是为什么 Booster 统一收敛了 transform 的过程，用一次 I&#x2F;O 解决所有 classes 的 transform 问题。</p>
<img src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjIzN3B4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NzAxcHg7aGVpZ2h0OjIzN3B4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDcwMSAyMzciIHdpZHRoPSI3MDFweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIGFncDctLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9ImFncDciIGRhdGEtc291cmNlLWxpbmU9IjgiIGRhdGEtdWlkPSJlbnQwMDA0IiBpZD0iY2x1c3Rlcl9hZ3A3Ij48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9Ijg3LjMiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI0ODMiIHg9IjciIHk9IjE0NC4yOSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxOTYuOTc3NSIgeD0iMTUwLjAxMTIiIHk9IjE1OS4yODUxIj5BR1AgSW5zdHJ1bWVudGF0aW9uIEFQSTwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgR3JhZGxlLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJHcmFkbGUiIGRhdGEtc291cmNlLWxpbmU9IjEzIiBkYXRhLXVpZD0iZW50MDAwNyIgaWQ9ImNsdXN0ZXJfR3JhZGxlIj48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9Ijg3LjMiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxNjgiIHg9IjUxNCIgeT0iMTQ0LjI5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUyLjE1ODIiIHg9IjU3MS45MjA5IiB5PSIxNTkuMjg1MSI+R3JhZGxlPC90ZXh0PjwvZz48IS0tZW50aXR5IEFzbUNsYXNzZXNUcmFuc2Zvcm0tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iQXNtQ2xhc3Nlc1RyYW5zZm9ybSIgZGF0YS1zb3VyY2UtbGluZT0iOSIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJlbnRpdHlfQXNtQ2xhc3Nlc1RyYW5zZm9ybSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzNi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNzUuMTg5NSIgeD0iMjMuNDEiIHk9IjE3OS4yOSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE1NS4xODk1IiB4PSIzMy40MSIgeT0iMjAyLjI4NTEiPkFzbUNsYXNzZXNUcmFuc2Zvcm08L3RleHQ+PC9nPjwhLS1lbnRpdHkgVHJhbnNmb3JtQ2xhc3Nlc1dpdGhBc21UYXNrLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IlRyYW5zZm9ybUNsYXNzZXNXaXRoQXNtVGFzayIgZGF0YS1zb3VyY2UtbGluZT0iMTAiIGRhdGEtdWlkPSJlbnQwMDA2IiBpZD0iZW50aXR5X1RyYW5zZm9ybUNsYXNzZXNXaXRoQXNtVGFzayI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzNi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIyMzkuODE2NCIgeD0iMjM0LjA5IiB5PSIxNzkuMjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMTkuODE2NCIgeD0iMjQ0LjA5IiB5PSIyMDIuMjg1MSI+VHJhbnNmb3JtQ2xhc3Nlc1dpdGhBc21UYXNrPC90ZXh0PjwvZz48IS0tZW50aXR5IFRyYW5zZm9ybUFjdGlvbi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJUcmFuc2Zvcm1BY3Rpb24iIGRhdGEtc291cmNlLWxpbmU9IjE0IiBkYXRhLXVpZD0iZW50MDAwOCIgaWQ9ImVudGl0eV9UcmFuc2Zvcm1BY3Rpb24iPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTM2LjAzMzIiIHg9IjUyOS45OCIgeT0iMTc5LjI5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTE2LjAzMzIiIHg9IjUzOS45OCIgeT0iMjAyLjI4NTEiPlRyYW5zZm9ybUFjdGlvbjwvdGV4dD48L2c+PCEtLWVudGl0eSBkZXBzLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9ImRlcHMiIGRhdGEtc291cmNlLWxpbmU9IjUiIGRhdGEtdWlkPSJlbnQwMDAyIiBpZD0iZW50aXR5X2RlcHMiPjxyZWN0IGZpbGw9IiNDOUZGQzkiIGhlaWdodD0iNTEuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTk1Ljc4NjEiIHg9IjUwMC4xMSIgeT0iNyIvPjxpbWFnZSBoZWlnaHQ9IjE2IiB3aWR0aD0iMTYiIHg9IjU5MC41MDMxIiB4bGluazpocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQVFDQVlBQUFBZjgvOWhBQUFBUVVsRVFWUjRYbU5nR0d6Z0h3NU1OUGgzOHZuMi84Z1lKQWJGUkFHc0JpQVpSQkRnTklCWVE3QWFnQVhqQkJnR29HT1FHblJOeUdEVUFHb1lRQ1FlUkFBQUQva09iT1grdDJRQUFBQUFTVVZPUks1Q1lJST0iIHk9IjE3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc1Ljc4NjEiIHg9IjUxMC4xMSIgeT0iNDQuOTk1MSI+RGVwZW5kZW5jeSBDbGFzc2VzL0phcnM8L3RleHQ+PC9nPjwhLS1lbnRpdHkgY2xhc3Nlcy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJjbGFzc2VzIiBkYXRhLXNvdXJjZS1saW5lPSI2IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImVudGl0eV9jbGFzc2VzIj48cmVjdCBmaWxsPSIjQzlGRkM5IiBoZWlnaHQ9IjUxLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE1Ni4xMTcyIiB4PSIyNzUuOTQiIHk9IjciLz48aW1hZ2UgaGVpZ2h0PSIxNiIgd2lkdGg9IjE2IiB4PSIzNDYuNDk4NiIgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCQUFBQUFRQ0FZQUFBQWY4LzloQUFBQVFVbEVRVlI0WG1OZ0dHemdIdzVNTlBoMzh2bjIvOGdZSkFiRlJBR3NCaUFaUkJEZ05JQllRN0FhZ0FYakJCZ0dvR09RR25STnlHRFVBR29ZUUNRZVJBQUFEL2tPYk9YK3QyUUFBQUFBU1VWT1JLNUNZSUk9IiB5PSIxNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzNi4xMTcyIiB4PSIyODUuOTQiIHk9IjQ0Ljk5NTEiPlByb2plY3QgQ2xhc3Nlcy9KYXJzPC90ZXh0PjwvZz48IS0tbGluayBkZXBzIHRvIFRyYW5zZm9ybUFjdGlvbi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJkZXBzIiBkYXRhLWVudGl0eS0yPSJUcmFuc2Zvcm1BY3Rpb24iIGRhdGEtc291cmNlLWxpbmU9IjE3IiBkYXRhLXVpZD0ibG5rOSIgaWQ9ImxpbmtfZGVwc19UcmFuc2Zvcm1BY3Rpb24iPjxwYXRoIGQ9Ik01OTgsNTguNzIgQzU5OCw5Mi4wOCA1OTgsMTQ0LjE5IDU5OCwxNzMuMDkiIGZpbGw9Im5vbmUiIGlkPSJkZXBzLXRvLVRyYW5zZm9ybUFjdGlvbiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjU5OCwxNzkuMDksNjAyLDE3MC4wOSw1OTgsMTc0LjA5LDU5NCwxNzAuMDksNTk4LDE3OS4wOSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayBjbGFzc2VzIHRvIFRyYW5zZm9ybUNsYXNzZXNXaXRoQXNtVGFzay0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJjbGFzc2VzIiBkYXRhLWVudGl0eS0yPSJUcmFuc2Zvcm1DbGFzc2VzV2l0aEFzbVRhc2siIGRhdGEtc291cmNlLWxpbmU9IjE4IiBkYXRhLXVpZD0ibG5rMTAiIGlkPSJsaW5rX2NsYXNzZXNfVHJhbnNmb3JtQ2xhc3Nlc1dpdGhBc21UYXNrIj48cGF0aCBkPSJNMzU0LDU4LjcyIEMzNTQsOTIuMDggMzU0LDE0NC4xOSAzNTQsMTczLjA5IiBmaWxsPSJub25lIiBpZD0iY2xhc3Nlcy10by1UcmFuc2Zvcm1DbGFzc2VzV2l0aEFzbVRhc2siIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzNTQsMTc5LjA5LDM1OCwxNzAuMDksMzU0LDE3NC4wOSwzNTAsMTcwLjA5LDM1NCwxNzkuMDkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgQXNtQ2xhc3Nlc1RyYW5zZm9ybSB0byBUcmFuc2Zvcm1BY3Rpb24tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iQXNtQ2xhc3Nlc1RyYW5zZm9ybSIgZGF0YS1lbnRpdHktMj0iVHJhbnNmb3JtQWN0aW9uIiBkYXRhLXNvdXJjZS1saW5lPSIxOSIgZGF0YS11aWQ9ImxuazExIiBpZD0ibGlua19Bc21DbGFzc2VzVHJhbnNmb3JtX1RyYW5zZm9ybUFjdGlvbiI+PHBhdGggZD0iTTEzNC4zMywxNzguOCBDMTU3Ljk1LDE2MS4zMSAxOTYuMzYsMTM2LjU3IDIzNC41LDEyNy43OSBDMjYwLjI3LDEyMS44NyA0NDYuNzMsMTIxLjg3IDQ3Mi41LDEyNy43OSBDNTExLjExLDEzNi42NyA1MzUuNjAxOCwxNTAuODE4IDU1OS42NjE4LDE2OC4yNzgiIGZpbGw9Im5vbmUiIGlkPSJBc21DbGFzc2VzVHJhbnNmb3JtLXRvLVRyYW5zZm9ybUFjdGlvbiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9Im5vbmUiIHBvaW50cz0iNTc0LjIzLDE3OC44NSw1NjMuMTg1NywxNjMuNDIyLDU1Ni4xMzc4LDE3My4xMzQxLDU3NC4yMywxNzguODUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLVNSQz1bVEwxRFF1RDA0QnR4QW1QcHJhOFh6MkEyZjEzSWFtVVh2LWF3cU10U01QZFA1NEJRX3J2REtxRkd4NkxYdGlVeUR0Z210QUVXMG80SmE5a0Vpa28zTWxvb05sOFNwWDRDSl9vSHd1cU45ZTdkVFZHSkhJWWNqR3UzbVFlWXF4QmxWN0UyLTlMd3VmaE9kNjNKZUloZnFua0FuZTBBRFZLQU1IT2NVZThJeDF2RG9GRDdWZ051cG83TnRDcHkzSHh3SExDVG1BUF82SUxuaUlyWG5uaGF3OFczMWtpUFlkOE5OcWhVLThNd3d4ZkFhN05sblR0WHFfSkFVaFVYN0pHTHdjNnlwOHN1NVFvN3h4b2lCaW1PTzVIUzNmRWNRSnUzX3JsVVdtang1cDkzOGlkdHBGOE5dLS0+PC9nPjwvc3ZnPg=='>

<h3 id="并行执行"><a href="#并行执行" class="headerlink" title="并行执行"></a>并行执行</h3><p>另一个问题是 AGP 自身的 transform 的实现本身，无论是 legacy 的 <code>TransformTask</code> 还是 <code>TransformClassesWithAsmTask</code> 都还是以串行处理为主，并不能实现完全并行处理，还有相当大的优化空间。</p>
<p>以 <code>TransformTask</code> 为例，其实现是每个 <code>Transform</code> 创建一个任务，而且，AGP 自身就搞了很多 <code>Transform</code> 组成一个 Transform 链，上一个处理完了，把结果写到磁盘某个位置，把路径传给下一个 <code>TransformTask</code> 来处理，再在另一个位置写磁盘，如此循环下去直至所有 <code>Transform</code> 对应的任务执行完成，所以，<code>Transform</code> 越多，对应的 <code>TransformTask</code> 的实例也就越多，同时，I&#x2F;O 次数也会呈线性增长。</p>
<img src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjgxcHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDo4MzRweDtoZWlnaHQ6ODFweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA4MzQgODEiIHdpZHRoPSI4MzRweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1lbnRpdHkgY2xhc3Nlcy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJjbGFzc2VzIiBkYXRhLXNvdXJjZS1saW5lPSI2IiBkYXRhLXVpZD0iZW50MDAwMiIgaWQ9ImVudGl0eV9jbGFzc2VzIj48cmVjdCBmaWxsPSIjQzlGRkM5IiBoZWlnaHQ9IjUxLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEwMy4yMTM5IiB4PSI3IiB5PSIxNS44Ii8+PGltYWdlIGhlaWdodD0iMTYiIHdpZHRoPSIxNiIgeD0iNTEuMTA2OSIgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCQUFBQUFRQ0FZQUFBQWY4LzloQUFBQVFVbEVRVlI0WG1OZ0dHemdIdzVNTlBoMzh2bjIvOGdZSkFiRlJBR3NCaUFaUkJEZ05JQllRN0FhZ0FYakJCZ0dvR09RR25STnlHRFVBR29ZUUNRZVJBQUFEL2tPYk9YK3QyUUFBQUFBU1VWT1JLNUNZSUk9IiB5PSIyNS44Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuMjEzOSIgeD0iMTciIHk9IjUzLjc5NTEiPkNsYXNzZXMvSmFyczwvdGV4dD48L2c+PCEtLWVudGl0eSBkOC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJkOCIgZGF0YS1zb3VyY2UtbGluZT0iNyIgZGF0YS11aWQ9ImVudDAwMDMiIGlkPSJlbnRpdHlfZDgiPjxyZWN0IGZpbGw9IiNDOUZGQzkiIGhlaWdodD0iNTEuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMzkuNjg3NSIgeD0iNzg4LjM4IiB5PSIxNS44Ii8+PGltYWdlIGhlaWdodD0iMTYiIHdpZHRoPSIxNiIgeD0iODAwLjcyMzgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBUUNBWUFBQUFmOC85aEFBQUFUVWxFUVZSNFhtTmdHQ3JnSDdvQXFRQmtBRVdHL0R2NWZQdC9FSTB1QVFNd0czQmlrQUg0RElFcklBYUQxRk5rQURaRFNESUFYVFBZQUVJWW4yWmlBTUZZSUFSZ0xpRWJVS1I1a0FNQVJUNnJxUzZjQTRzQUFBQUFTVVZPUks1Q1lJST0iIHk9IjI1LjgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxOS42ODc1IiB4PSI3OTguMzgiIHk9IjUzLjc5NTEiPkQ4PC90ZXh0PjwvZz48IS0tZW50aXR5IHRmMS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJ0ZjEiIGRhdGEtc291cmNlLWxpbmU9IjkiIGRhdGEtdWlkPSJlbnQwMDA0IiBpZD0iZW50aXR5X3RmMSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2OC44OTA2IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNDYuMDU0NyIgeD0iMTcwLjIxIiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTIxLjYwNDUiIHg9IjE4MC4yMSIgeT0iMjkuOTk1MSI+JiMxNzE7VHJhbnNmb3JtVGFzayYjMTg3OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0LjQ1MDIiIHg9IjE4MC4yMSIgeT0iNDYuMjkyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODUuMjk4OCIgeD0iMjAyLjQ2MSIgeT0iNjIuNTg4OSI+VHJhbnNmb3JtIDE8L3RleHQ+PC9nPjwhLS1lbnRpdHkgdGYyLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9InRmMiIgZGF0YS1zb3VyY2UtbGluZT0iMTAiIGRhdGEtdWlkPSJlbnQwMDA1IiBpZD0iZW50aXR5X3RmMiI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2OC44OTA2IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNDYuMDU0NyIgeD0iMzc2LjI3IiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTIxLjYwNDUiIHg9IjM4Ni4yNyIgeT0iMjkuOTk1MSI+JiMxNzE7VHJhbnNmb3JtVGFzayYjMTg3OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0LjQ1MDIiIHg9IjM4Ni4yNyIgeT0iNDYuMjkyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODUuMjk4OCIgeD0iNDA4LjUyMSIgeT0iNjIuNTg4OSI+VHJhbnNmb3JtIDI8L3RleHQ+PC9nPjwhLS1lbnRpdHkgdGZuLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9InRmbiIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGRhdGEtdWlkPSJlbnQwMDA2IiBpZD0iZW50aXR5X3RmbiI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2OC44OTA2IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNDYuMDU0NyIgeD0iNTgyLjMyIiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTIxLjYwNDUiIHg9IjU5Mi4zMiIgeT0iMjkuOTk1MSI+JiMxNzE7VHJhbnNmb3JtVGFzayYjMTg3OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0LjQ1MDIiIHg9IjU5Mi4zMiIgeT0iNDYuMjkyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTMuMzUwNiIgeD0iNjU5LjA3MjkiIHk9IjYyLjU4ODkiPi4uLjwvdGV4dD48L2c+PCEtLWxpbmsgY2xhc3NlcyB0byB0ZjEtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iY2xhc3NlcyIgZGF0YS1lbnRpdHktMj0idGYxIiBkYXRhLXNvdXJjZS1saW5lPSIxMyIgZGF0YS11aWQ9ImxuazciIGlkPSJsaW5rX2NsYXNzZXNfdGYxIj48cGF0aCBkPSJNMTEwLjQ4LDQxLjQ0IEMxMjguODUsNDEuNDQgMTQzLjk1LDQxLjQ0IDE2My44LDQxLjQ0IiBmaWxsPSJub25lIiBpZD0iY2xhc3Nlcy10by10ZjEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE2OS44LDQxLjQ0LDE2MC44LDM3LjQ0LDE2NC44LDQxLjQ0LDE2MC44LDQ1LjQ0LDE2OS44LDQxLjQ0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmMSB0byB0ZjItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0idGYxIiBkYXRhLWVudGl0eS0yPSJ0ZjIiIGRhdGEtc291cmNlLWxpbmU9IjE0IiBkYXRhLXVpZD0ibG5rOCIgaWQ9ImxpbmtfdGYxX3RmMiI+PHBhdGggZD0iTTMxNi43Niw0MS40NCBDMzM2LDQxLjQ0IDM1MC43OCw0MS40NCAzNzAuMDEsNDEuNDQiIGZpbGw9Im5vbmUiIGlkPSJ0ZjEtdG8tdGYyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzNzYuMDEsNDEuNDQsMzY3LjAxLDM3LjQ0LDM3MS4wMSw0MS40NCwzNjcuMDEsNDUuNDQsMzc2LjAxLDQxLjQ0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmMiB0byB0Zm4tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0idGYyIiBkYXRhLWVudGl0eS0yPSJ0Zm4iIGRhdGEtc291cmNlLWxpbmU9IjE1IiBkYXRhLXVpZD0ibG5rOSIgaWQ9ImxpbmtfdGYyX3RmbiI+PHBhdGggZD0iTTUyMi44MSw0MS40NCBDNTQyLjA2LDQxLjQ0IDU1Ni44Myw0MS40NCA1NzYuMDcsNDEuNDQiIGZpbGw9Im5vbmUiIGlkPSJ0ZjItdG8tdGZuIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI1ODIuMDcsNDEuNDQsNTczLjA3LDM3LjQ0LDU3Ny4wNyw0MS40NCw1NzMuMDcsNDUuNDQsNTgyLjA3LDQxLjQ0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmbiB0byBkOC0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJ0Zm4iIGRhdGEtZW50aXR5LTI9ImQ4IiBkYXRhLXNvdXJjZS1saW5lPSIxNiIgZGF0YS11aWQ9ImxuazEwIiBpZD0ibGlua190Zm5fZDgiPjxwYXRoIGQ9Ik03MjguNjksNDEuNDQgQzc1MC42Miw0MS40NCA3NjYuOSw0MS40NCA3ODIuMSw0MS40NCIgZmlsbD0ibm9uZSIgaWQ9InRmbi10by1kOCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNzg4LjEsNDEuNDQsNzc5LjEsMzcuNDQsNzgzLjEsNDEuNDQsNzc5LjEsNDUuNDQsNzg4LjEsNDEuNDQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLVNSQz1bWlAyblFpR20zOFB0Rk9MbXZ3SFNlOTMxVUJiRWRKRlVlWmZFT1l3SDN5YWpiRDl0UnpwR2Iwb2JyVkdad0hDVmNpRUdDSVVLRTR1UC1vWjF2dldPejFodkhhOEJiV3huRTBUaGR5RDRocDY5U19XRWs5UWE1LXhGSUpXOERXX20wSzNZZnhYRzNkWk4xSnpuY2pGdVhrT3lhc2hHLW9TSURLWUFWY2tXak5iVmdxWG83Q1hkdnR3eHl6WC1xTnJ4MTYtSVY1MVRFVFhyQ0ctZGlja2l4T0hPWG9IQkh0ZlR2SXp5dVFBRi1tMUZ2YTBzX29VUjh5Yl9hSnpMcnhLMS1GdjRMUmNZMzRMeG9tcUthSXFwYkRDYnotcWRdLS0+PC9nPjwvc3ZnPg=='>

<p>尽管 AGP 后来又搞出来一个 <code>TransformClassesWithAsmTask</code>，但其实现都是用一个 <em>for</em> 循环来实现的：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">processJars</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  instrumentationManager: <span class="type">AsmInstrumentationManager</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">  inputChanges: <span class="type">InputChanges</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">  isIncremental: <span class="type">Boolean</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (inputJarsDir.isPresent) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isIncremental) &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      FileUtils.deleteDirectoryContents(jarsOutputDir.<span class="keyword">get</span>().asFile)</span><br><span class="line">      extractProfilerDependencyJars()</span><br><span class="line">      inputJarsDir.<span class="keyword">get</span>().asFile.listFiles()?.forEach &#123; inputJar -&gt;</span><br><span class="line">        <span class="keyword">val</span> instrumentedJar = File(jarsOutputDir.<span class="keyword">get</span>().asFile, inputJar.name)</span><br><span class="line">        instrumentationManager.instrumentClassesFromJarToJar(inputJar, instrumentedJar)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直到 AGP 7.1 才实现 JAR 的并行处理，使用的是 Gradle 的 <a target="_blank" rel="noopener" href="https://docs.gradle.org/current/javadoc/org/gradle/workers/WorkerExecutor.html">WorkerExecutor</a>，不仅可以最大化的使用 CPU 资源，还可以最大限度的复用 Gradle 的缓存机制。</p>
<p>虽然 AGP 的实现比较挫，但跟 Legacy 的 Transform API 相比进步也是巨大的，主要体现在由原来的多个 <code>TransformTask</code> 变成了单一的 <code>TransformClassesWithAsmTask</code>，极大的降低了 I&#x2F;O 的损耗。</p>
<img src='data:image/svg+xml;base64,ZXJyb3IgY29kZTogNTIw'>

<h2 id="Booster-的思路"><a href="#Booster-的思路" class="headerlink" title="Booster 的思路"></a>Booster 的思路</h2><h3 id="Artifacts-API"><a href="#Artifacts-API" class="headerlink" title="Artifacts API"></a>Artifacts API</h3><p><a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/4.1/com/android/build/api/artifact/Artifacts">Artifacts API</a> 是 AGP 4.1 新增的 API，那时候 AGP 搞这么一套 API 在我们看来意图也并不明显，因为这并不是无中生有的一套 API，而是基于原来的 <a target="_blank" rel="noopener" href="https://android.googlesource.com/platform/tools/base/+/35bf92626adc6a61e647c907661029e7243f0eaf/build-system/gradle-core/src/main/java/com/android/build/gradle/internal/scope/VariantScope.java#68">VariantScope.getArtifacts()</a> 来重新设计的，原来的 <code>Artifacts</code> 比较分散，都是些 internal 的 API，主要是在 AGP 内部使用。虽然 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/4.1/com/android/build/api/artifact/Artifacts">Artifacts API</a> 从 AGP 4.1 就有了，但一直在变动，直到 AGP 7.2 才真正稳定下来。</p>
<p>和原来的 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.2/com/android/build/api/transform/Transform">Transform API</a> 类似， <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/4.1/com/android/build/api/artifact/Artifacts">Artifacts API</a> 的实现也是需要 <code>Task</code> 来支持的，具体实现可以参考 <code>TransformClassesWithAsmTask</code>，虽然跟 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.2/com/android/build/api/transform/Transform">Transform API</a> 相比，大大减少了不必要的 I&#x2F;O，但如果开发者还基于这套 API 来实现自定义的 transform 的话，只是代码的编写上比原来直接操作 task 要方便了很多，但执行起来跟原来的 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.2/com/android/build/api/transform/Transform">Transform API</a> 在本质上并没有多大区别，还是前一个 task 处理完将结果交给下一个 task 处理的模式，还是没法并行处理。</p>
<img src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjgxcHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDo5NjRweDtoZWlnaHQ6ODFweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA5NjQgODEiIHdpZHRoPSI5NjRweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1lbnRpdHkgY2xhc3Nlcy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJjbGFzc2VzIiBkYXRhLXNvdXJjZS1saW5lPSI2IiBkYXRhLXVpZD0iZW50MDAwMiIgaWQ9ImVudGl0eV9jbGFzc2VzIj48cmVjdCBmaWxsPSIjQzlGRkM5IiBoZWlnaHQ9IjUxLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEwMy4yMTM5IiB4PSI3IiB5PSIxNS44Ii8+PGltYWdlIGhlaWdodD0iMTYiIHdpZHRoPSIxNiIgeD0iNTEuMTA2OSIgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCQUFBQUFRQ0FZQUFBQWY4LzloQUFBQVFVbEVRVlI0WG1OZ0dHemdIdzVNTlBoMzh2bjIvOGdZSkFiRlJBR3NCaUFaUkJEZ05JQllRN0FhZ0FYakJCZ0dvR09RR25STnlHRFVBR29ZUUNRZVJBQUFEL2tPYk9YK3QyUUFBQUFBU1VWT1JLNUNZSUk9IiB5PSIyNS44Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuMjEzOSIgeD0iMTciIHk9IjUzLjc5NTEiPkNsYXNzZXMvSmFyczwvdGV4dD48L2c+PCEtLWVudGl0eSBkOC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJkOCIgZGF0YS1zb3VyY2UtbGluZT0iNyIgZGF0YS11aWQ9ImVudDAwMDMiIGlkPSJlbnRpdHlfZDgiPjxyZWN0IGZpbGw9IiNDOUZGQzkiIGhlaWdodD0iNTEuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMzkuNjg3NSIgeD0iOTE4LjkiIHk9IjE1LjgiLz48aW1hZ2UgaGVpZ2h0PSIxNiIgd2lkdGg9IjE2IiB4PSI5MzEuMjQzOCIgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCQUFBQUFRQ0FZQUFBQWY4LzloQUFBQVRVbEVRVlI0WG1OZ0dDcmdIN29BcVFCa0FFV0cvRHY1ZlB0L0VJMHVBUU13RzNCaWtBSDRESUVySUFhRDFGTmtBRFpEU0RJQVhUUFlBRUlZbjJaaUFNRllJQVJnTGlFYlVLUjVrQU1BUlQ2cnFTNmNBNHNBQUFBQVNVVk9SSzVDWUlJPSIgeT0iMjUuOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE5LjY4NzUiIHg9IjkyOC45IiB5PSI1My43OTUxIj5EODwvdGV4dD48L2c+PCEtLWVudGl0eSB0ZjAtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0idGYwIiBkYXRhLXNvdXJjZS1saW5lPSI5IiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV90ZjAiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNjguODkwNiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMjQ0LjI2NjYiIHg9IjE3MC4yMSIgeT0iNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ5LjY2MzEiIHg9IjI4Mi41NjQ1IiB5PSIyOS45OTUxIj4mIzE3MTtUYXNrJiMxODc7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQuNDUwMiIgeD0iMTgwLjIxIiB5PSI0Ni4yOTIiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMTkuODE2NCIgeD0iMTg0LjY2MDIiIHk9IjYyLjU4ODkiPlRyYW5zZm9ybUNsYXNzZXNXaXRoQXNtVGFzazwvdGV4dD48L2c+PCEtLWVudGl0eSB0ZjEtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0idGYxIiBkYXRhLXNvdXJjZS1saW5lPSIxMCIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJlbnRpdHlfdGYxIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjY4Ljg5MDYiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjkwLjcwNDEiIHg9IjQ3NC40OCIgeT0iNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ5LjY2MzEiIHg9IjQ5Ny44MzA2IiB5PSIyOS45OTUxIj4mIzE3MTtUYXNrJiMxODc7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQuNDUwMiIgeD0iNDg0LjQ4IiB5PSI0Ni4yOTIiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2Ni4yNTM5IiB4PSI0ODguOTMwMiIgeT0iNjIuNTg4OSI+TXlUYXNrIDE8L3RleHQ+PC9nPjwhLS1lbnRpdHkgdGYyLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9InRmMiIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGRhdGEtdWlkPSJlbnQwMDA2IiBpZD0iZW50aXR5X3RmMiI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2OC44OTA2IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI5MC43MDQxIiB4PSI2MjUuMTgiIHk9IjciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0OS42NjMxIiB4PSI2NDguNTMwNiIgeT0iMjkuOTk1MSI+JiMxNzE7VGFzayYjMTg3OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0LjQ1MDIiIHg9IjYzNS4xOCIgeT0iNDYuMjkyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjYuMjUzOSIgeD0iNjM5LjYzMDIiIHk9IjYyLjU4ODkiPk15VGFzayAyPC90ZXh0PjwvZz48IS0tZW50aXR5IHRmbi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJ0Zm4iIGRhdGEtc291cmNlLWxpbmU9IjEyIiBkYXRhLXVpZD0iZW50MDAwNyIgaWQ9ImVudGl0eV90Zm4iPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNjguODkwNiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iODMuMDEzNyIgeD0iNzc1Ljg5IiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDkuNjYzMSIgeD0iNzk0Ljc5MDQiIHk9IjI5Ljk5NTEiPiYjMTcxO1Rhc2smIzE4Nzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNC40NTAyIiB4PSI3ODUuODkiIHk9IjQ2LjI5MiI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzLjM1MDYiIHg9IjgxMi41OTEyIiB5PSI2Mi41ODg5Ij4uLi48L3RleHQ+PC9nPjwhLS1saW5rIGNsYXNzZXMgdG8gdGYwLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImNsYXNzZXMiIGRhdGEtZW50aXR5LTI9InRmMCIgZGF0YS1zb3VyY2UtbGluZT0iMTQiIGRhdGEtdWlkPSJsbms4IiBpZD0ibGlua19jbGFzc2VzX3RmMCI+PHBhdGggZD0iTTExMC40Niw0MS40NCBDMTI4LjE4LDQxLjQ0IDE0Mi45LDQxLjQ0IDE2My44Nyw0MS40NCIgZmlsbD0ibm9uZSIgaWQ9ImNsYXNzZXMtdG8tdGYwIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxNjkuODcsNDEuNDQsMTYwLjg3LDM3LjQ0LDE2NC44Nyw0MS40NCwxNjAuODcsNDUuNDQsMTY5Ljg3LDQxLjQ0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmMCB0byB0ZjEtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0idGYwIiBkYXRhLWVudGl0eS0yPSJ0ZjEiIGRhdGEtc291cmNlLWxpbmU9IjE1IiBkYXRhLXVpZD0ibG5rOSIgaWQ9ImxpbmtfdGYwX3RmMSI+PHBhdGggZD0iTTQxNC42Nyw0MS40NCBDNDM1Ljk0LDQxLjQ0IDQ1MC43OSw0MS40NCA0NjguMTksNDEuNDQiIGZpbGw9Im5vbmUiIGlkPSJ0ZjAtdG8tdGYxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI0NzQuMTksNDEuNDQsNDY1LjE5LDM3LjQ0LDQ2OS4xOSw0MS40NCw0NjUuMTksNDUuNDQsNDc0LjE5LDQxLjQ0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmMSB0byB0ZjItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0idGYxIiBkYXRhLWVudGl0eS0yPSJ0ZjIiIGRhdGEtc291cmNlLWxpbmU9IjE2IiBkYXRhLXVpZD0ibG5rMTAiIGlkPSJsaW5rX3RmMV90ZjIiPjxwYXRoIGQ9Ik01NjUuNDUsNDEuNDQgQzU4NC4xOCw0MS40NCA1OTkuOTQsNDEuNDQgNjE4LjcsNDEuNDQiIGZpbGw9Im5vbmUiIGlkPSJ0ZjEtdG8tdGYyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI2MjQuNyw0MS40NCw2MTUuNywzNy40NCw2MTkuNyw0MS40NCw2MTUuNyw0NS40NCw2MjQuNyw0MS40NCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB0ZjIgdG8gdGZuLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InRmMiIgZGF0YS1lbnRpdHktMj0idGZuIiBkYXRhLXNvdXJjZS1saW5lPSIxNyIgZGF0YS11aWQ9ImxuazExIiBpZD0ibGlua190ZjJfdGZuIj48cGF0aCBkPSJNNzE2LjE4LDQxLjQ0IEM3MzUuMTMsNDEuNDQgNzUxLjA4LDQxLjQ0IDc2OS42LDQxLjQ0IiBmaWxsPSJub25lIiBpZD0idGYyLXRvLXRmbiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNzc1LjYsNDEuNDQsNzY2LjYsMzcuNDQsNzcwLjYsNDEuNDQsNzY2LjYsNDUuNDQsNzc1LjYsNDEuNDQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgdGZuIHRvIGQ4LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InRmbiIgZGF0YS1lbnRpdHktMj0iZDgiIGRhdGEtc291cmNlLWxpbmU9IjE4IiBkYXRhLXVpZD0ibG5rMTIiIGlkPSJsaW5rX3Rmbl9kOCI+PHBhdGggZD0iTTg1OS4xNCw0MS40NCBDODc5LjI2LDQxLjQ0IDg5Ni41OSw0MS40NCA5MTIuNTcsNDEuNDQiIGZpbGw9Im5vbmUiIGlkPSJ0Zm4tdG8tZDgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjkxOC41Nyw0MS40NCw5MDkuNTcsMzcuNDQsOTEzLjU3LDQxLjQ0LDkwOS41Nyw0NS40NCw5MTguNTcsNDEuNDQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLVNSQz1bVlAxMVF5Q20zOE5sLVhLWUVvVFIwZUNTWjY1cWZ5NWtXTHJ3cUhtZENLdGE4ZGszQ2xSVjVwVGptUjFEZnNWbmxJVjlpbnFZSGVfWW5ZYll4eUlRdzNuM0UzVy1hajIyZ0tDeXBiUWZUcGxIZl9FWUROdTFoWU4tV19rVDV4UTJwSUR5MHYyT29JcUtCVHZycmFwaVBwLVVpRFpENTg4RHpveWFlSzBBUUJPNkFYTGxNNGFJdEswY1Fsck5wZER4VGxUalJab0FEcFE0ckdVdFRKNEUzdWFqeUZUSWdnRG1NNF9QeXZ3bjQtOG1VNWFrY3h3dkUzczU5STU1YmJiVkN0Rl93b2N6aUN4WHZiLXVvTTYtbTNieGhnZ2cyZTNoZHZNYkppVDFFZDNKRFFKNURqcjBjaGpmWFhJUlREXy0wMDAwXS0tPjwvZz48L3N2Zz4='>

<p>对于 Booster 而言，如果能统一这些自定义 transform 的 task，就可以大大减少不必要的 I&#x2F;O 操作</p>
<img src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjI3NHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NzMycHg7aGVpZ2h0OjI3NHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDczMiAyNzQiIHdpZHRoPSI3MzJweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1lbnRpdHkgY2xhc3Nlcy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJjbGFzc2VzIiBkYXRhLXNvdXJjZS1saW5lPSI1IiBkYXRhLXVpZD0iZW50MDAwMiIgaWQ9ImVudGl0eV9jbGFzc2VzIj48cmVjdCBmaWxsPSIjQzlGRkM5IiBoZWlnaHQ9IjUxLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEwMy4yMTM5IiB4PSI3IiB5PSIxNS43OSIvPjxpbWFnZSBoZWlnaHQ9IjE2IiB3aWR0aD0iMTYiIHg9IjUxLjEwNjkiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBUUNBWUFBQUFmOC85aEFBQUFRVWxFUVZSNFhtTmdHR3pnSHc1TU5QaDM4dm4yLzhnWUpBYkZSQUdzQmlBWlJCRGdOSUJZUTdBYWdBWGpCQmdHb0dPUUduUk55R0RVQUdvWVFDUWVSQUFBRC9rT2JPWCt0MlFBQUFBQVNVVk9SSzVDWUlJPSIgeT0iMjUuNzkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4My4yMTM5IiB4PSIxNyIgeT0iNTMuNzg1MSI+Q2xhc3Nlcy9KYXJzPC90ZXh0PjwvZz48IS0tZW50aXR5IGQ4LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9ImQ4IiBkYXRhLXNvdXJjZS1saW5lPSI2IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImVudGl0eV9kOCI+PHJlY3QgZmlsbD0iI0M5RkZDOSIgaGVpZ2h0PSI1MS4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIzOS42ODc1IiB4PSI2NDIuNzYiIHk9IjE1Ljc5Ii8+PGltYWdlIGhlaWdodD0iMTYiIHdpZHRoPSIxNiIgeD0iNjU1LjEwMzgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBUUNBWUFBQUFmOC85aEFBQUFUVWxFUVZSNFhtTmdHQ3JnSDdvQXFRQmtBRVdHL0R2NWZQdC9FSTB1QVFNd0czQmlrQUg0RElFcklBYUQxRk5rQURaRFNESUFYVFBZQUVJWW4yWmlBTUZZSUFSZ0xpRWJVS1I1a0FNQVJUNnJxUzZjQTRzQUFBQUFTVVZPUks1Q1lJST0iIHk9IjI1Ljc5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTkuNjg3NSIgeD0iNjUyLjc2IiB5PSI1My43ODUxIj5EODwvdGV4dD48L2c+PCEtLWVudGl0eSB0ZjAtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0idGYwIiBkYXRhLXNvdXJjZS1saW5lPSI4IiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV90ZjAiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNjguODkwNiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMjQ0LjI2NjYiIHg9IjE0NS40NyIgeT0iNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ5LjY2MzEiIHg9IjI1Ny44MjQ1IiB5PSIyOS45OTUxIj4mIzE3MTtUYXNrJiMxODc7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQuNDUwMiIgeD0iMTU1LjQ3IiB5PSI0Ni4yOTIiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMTkuODE2NCIgeD0iMTU5LjkyMDIiIHk9IjYyLjU4ODkiPlRyYW5zZm9ybUNsYXNzZXNXaXRoQXNtVGFzazwvdGV4dD48L2c+PCEtLWVudGl0eSB0Zm4tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0idGZuIiBkYXRhLXNvdXJjZS1saW5lPSI5IiBkYXRhLXVpZD0iZW50MDAwNSIgaWQ9ImVudGl0eV90Zm4iPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNjguODkwNiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTgyLjgxMTUiIHg9IjQyNS4yIiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDkuNjYzMSIgeD0iNTAxLjk1MjkiIHk9IjI5Ljk5NTEiPiYjMTcxO1Rhc2smIzE4Nzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNC40NTAyIiB4PSI0MzUuMiIgeT0iNDYuMjkyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTU4LjM2MTMiIHg9IjQzOS42NTAyIiB5PSI2Mi41ODg5Ij5Cb29zdGVyVHJhbnNmb3JtVGFzazwvdGV4dD48L2c+PCEtLWVudGl0eSB3MS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJ3MSIgZGF0YS1zb3VyY2UtbGluZT0iMTAiIGRhdGEtdWlkPSJlbnQwMDA2IiBpZD0iZW50aXR5X3cxIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjExMy43MjA3IiB4PSIzMTAuNzUiIHk9IjEzNS44OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkzLjcyMDciIHg9IjMyMC43NSIgeT0iMTU4Ljg4NTEiPldvcmtBY3Rpb24gMTwvdGV4dD48L2c+PCEtLWVudGl0eSB3Mi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJ3MiIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGRhdGEtdWlkPSJlbnQwMDA3IiBpZD0iZW50aXR5X3cyIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjExMy43MjA3IiB4PSI0NTkuNzUiIHk9IjEzNS44OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkzLjcyMDciIHg9IjQ2OS43NSIgeT0iMTU4Ljg4NTEiPldvcmtBY3Rpb24gMjwvdGV4dD48L2c+PCEtLWVudGl0eSB3bi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJ3biIgZGF0YS1zb3VyY2UtbGluZT0iMTIiIGRhdGEtdWlkPSJlbnQwMDA4IiBpZD0iZW50aXR5X3duIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjExOC4xNjQxIiB4PSI2MDguNTIiIHk9IjEzNS44OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk4LjE2NDEiIHg9IjYxOC41MiIgeT0iMTU4Ljg4NTEiPldvcmtBY3Rpb24gLi4uPC90ZXh0PjwvZz48IS0tZW50aXR5IGJ0Zi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJidGYiIGRhdGEtc291cmNlLWxpbmU9IjEzIiBkYXRhLXVpZD0iZW50MDAwOSIgaWQ9ImVudGl0eV9idGYiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTYwLjE5ODIiIHg9IjQzNi41MSIgeT0iMjMyLjE4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQwLjE5ODIiIHg9IjQ0Ni41MSIgeT0iMjU1LjE3NTEiPkJvb3N0ZXJUcmFuc2Zvcm1lcjwvdGV4dD48L2c+PCEtLWxpbmsgY2xhc3NlcyB0byB0ZjAtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iY2xhc3NlcyIgZGF0YS1lbnRpdHktMj0idGYwIiBkYXRhLXNvdXJjZS1saW5lPSIxNSIgZGF0YS11aWQ9ImxuazEwIiBpZD0ibGlua19jbGFzc2VzX3RmMCI+PHBhdGggZD0iTTExMC40NSw0MS40NCBDMTIyLjAxLDQxLjQ0IDEyNy41Nyw0MS40NCAxMzkuMTMsNDEuNDQiIGZpbGw9Im5vbmUiIGlkPSJjbGFzc2VzLXRvLXRmMCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTQ1LjEzLDQxLjQ0LDEzNi4xMywzNy40NCwxNDAuMTMsNDEuNDQsMTM2LjEzLDQ1LjQ0LDE0NS4xMyw0MS40NCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB0ZjAgdG8gdGZuLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InRmMCIgZGF0YS1lbnRpdHktMj0idGZuIiBkYXRhLXNvdXJjZS1saW5lPSIxNiIgZGF0YS11aWQ9ImxuazExIiBpZD0ibGlua190ZjBfdGZuIj48cGF0aCBkPSJNMzkwLjE2LDQxLjQ0IEM0MDEuNjksNDEuNDQgNDA3LjIxLDQxLjQ0IDQxOC43NCw0MS40NCIgZmlsbD0ibm9uZSIgaWQ9InRmMC10by10Zm4iIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjQyNC43NCw0MS40NCw0MTUuNzQsMzcuNDQsNDE5Ljc0LDQxLjQ0LDQxNS43NCw0NS40NCw0MjQuNzQsNDEuNDQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgdGZuIHRvIHcxLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InRmbiIgZGF0YS1lbnRpdHktMj0idzEiIGRhdGEtc291cmNlLWxpbmU9IjE3IiBkYXRhLXVpZD0ibG5rMTIiIGlkPSJsaW5rX3Rmbl93MSI+PHBhdGggZD0iTTQ3MS4wOSw3Ni4yMiBDNDQ0LjczLDk1Ljc5IDQxNy40NTc1LDExNi4wMzM1IDM5Ni4wNjc1LDEzMS45MTM1IiBmaWxsPSJub25lIiBpZD0idGZuLXRvLXcxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzOTEuMjUsMTM1LjQ5LDQwMC44NjA2LDEzMy4zMzY5LDM5NS4yNjQ2LDEzMi41MDk2LDM5Ni4wOTE5LDEyNi45MTM1LDM5MS4yNSwxMzUuNDkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgdGZuIHRvIHcyLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InRmbiIgZGF0YS1lbnRpdHktMj0idzIiIGRhdGEtc291cmNlLWxpbmU9IjE4IiBkYXRhLXVpZD0ibG5rMTMiIGlkPSJsaW5rX3Rmbl93MiI+PHBhdGggZD0iTTUxNi42MSw3Ni4yMiBDNTE2LjYxLDk1Ljc5IDUxNi42MSwxMTMuNjEgNTE2LjYxLDEyOS40OSIgZmlsbD0ibm9uZSIgaWQ9InRmbi10by13MiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNTE2LjYxLDEzNS40OSw1MjAuNjEsMTI2LjQ5LDUxNi42MSwxMzAuNDksNTEyLjYxLDEyNi40OSw1MTYuNjEsMTM1LjQ5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmbiB0byB3bi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJ0Zm4iIGRhdGEtZW50aXR5LTI9InduIiBkYXRhLXNvdXJjZS1saW5lPSIxOSIgZGF0YS11aWQ9ImxuazE0IiBpZD0ibGlua190Zm5fd24iPjxwYXRoIGQ9Ik01NjIuNzMsNzYuMjIgQzU4OS40NSw5NS43OSA2MTcuMTI5NiwxMTYuMDY0NSA2MzguODA5NiwxMzEuOTQ0NSIgZmlsbD0ibm9uZSIgaWQ9InRmbi10by13biIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNjQzLjY1LDEzNS40OSw2MzguNzUzLDEyNi45NDQ4LDYzOS42MTYzLDEzMi41MzU0LDYzNC4wMjU3LDEzMy4zOTg3LDY0My42NSwxMzUuNDkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgdzEgdG8gYnRmLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IncxIiBkYXRhLWVudGl0eS0yPSJidGYiIGRhdGEtc291cmNlLWxpbmU9IjIwIiBkYXRhLXVpZD0ibG5rMTUiIGlkPSJsaW5rX3cxX2J0ZiI+PHBhdGggZD0iTTM5NS4yOCwxNzIuNTUgQzQyMS45NiwxODkuNDMgNDU3LjA0LDIxMS42MzE0IDQ4My43NiwyMjguNTQxNCIgZmlsbD0ibm9uZSIgaWQ9IncxLXRvLWJ0ZiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNDg4LjgzLDIzMS43NSw0ODMuMzY0MSwyMjMuNTU3MSw0ODQuNjA1LDIyOS4wNzYyLDQ3OS4wODU5LDIzMC4zMTcxLDQ4OC44MywyMzEuNzUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgdzIgdG8gYnRmLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IncyIiBkYXRhLWVudGl0eS0yPSJidGYiIGRhdGEtc291cmNlLWxpbmU9IjIxIiBkYXRhLXVpZD0ibG5rMTYiIGlkPSJsaW5rX3cyX2J0ZiI+PHBhdGggZD0iTTUxNi42MSwxNzIuMzMgQzUxNi42MSwxODkuMjQgNTE2LjYxLDIwOC44NSA1MTYuNjEsMjI1LjgzIiBmaWxsPSJub25lIiBpZD0idzItdG8tYnRmIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI1MTYuNjEsMjMxLjgzLDUyMC42MSwyMjIuODMsNTE2LjYxLDIyNi44Myw1MTIuNjEsMjIyLjgzLDUxNi42MSwyMzEuODMiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgd24gdG8gYnRmLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InduIiBkYXRhLWVudGl0eS0yPSJidGYiIGRhdGEtc291cmNlLWxpbmU9IjIyIiBkYXRhLXVpZD0ibG5rMTciIGlkPSJsaW5rX3duX2J0ZiI+PHBhdGggZD0iTTYzOS41NiwxNzIuNTUgQzYxMi41MiwxODkuNDMgNTc2LjkxODcsMjExLjY2MTIgNTQ5Ljg0ODcsMjI4LjU3MTIiIGZpbGw9Im5vbmUiIGlkPSJ3bi10by1idGYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjU0NC43NiwyMzEuNzUsNTU0LjUxMjMsMjMwLjM3NDMsNTQ5LjAwMDYsMjI5LjEwMSw1NTAuMjczOSwyMjMuNTg5Myw1NDQuNzYsMjMxLjc1IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmbiB0byBkOC0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJ0Zm4iIGRhdGEtZW50aXR5LTI9ImQ4IiBkYXRhLXNvdXJjZS1saW5lPSIyMyIgZGF0YS11aWQ9ImxuazE4IiBpZD0ibGlua190Zm5fZDgiPjxwYXRoIGQ9Ik02MDguNDMsNDEuNDQgQzYxOS43MSw0MS40NCA2MjUsNDEuNDQgNjM2LjI5LDQxLjQ0IiBmaWxsPSJub25lIiBpZD0idGZuLXRvLWQ4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI2NDIuMjksNDEuNDQsNjMzLjI5LDM3LjQ0LDYzNy4yOSw0MS40NCw2MzMuMjksNDUuNDQsNjQyLjI5LDQxLjQ0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1TUkM9W1RMMzFSZUNtM0J0ZEFvbnNYV3NhSUhtWWZBdXh4T3BLSW96azIySzJkQ2g5TGF0Sl9kcTl3c1gxZEtfRlVTeWxwdFF6ZUhDb1ppMVFVUUpaZUFLeXcwdV9aRU1nV1l5MWVUWS1LeEVySjlnWFUxUlZHWTJocGVwZURKcEtNZExhMXRseVg2R3hlN0ZRRlJ1WGttSkdXVmZ6MDJkekI0a0hsTWJILVFod3AtVXJkQVFSU1pidU9na3FTczVFcDc3MWpxekhjeTN6YWg5NnJ1VEx6aEdkZzFkOWpQUjdJekFUeVR0NlpMNklCM3BmZGtWSXd5TFF2cE5GYmNrSlNwdnZ4MnB0Ni1NRDlTV05UQjZjWW1MRFFwaEJpYmwxbVJVSk9YcjNTb0I0dHpySkpnanU4SDZsVDZiOG5GTkk5WkpkXzBPTkR2WDRJM18xeThxOEtRLU9oZFpJSHpFY18wNDBdLS0+PC9nPjwvc3ZnPg=='>

<h3 id="Instrumentation-API"><a href="#Instrumentation-API" class="headerlink" title="Instrumentation API"></a>Instrumentation API</h3><p>最早在 <a href="/2021/08/02/the-deprecation-of-agp-transform-api/">《AGP Transform API 被废弃意味着什么？》</a> 一文中就提到了 Gradle 原生的 <a target="_blank" rel="noopener" href="https://docs.gradle.org/5.3/javadoc/org/gradle/api/artifacts/transform/TransformAction.html">TransformAction</a> API，而 AGP 从 4.2 开始提供的 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.2/com/android/build/api/variant/Instrumentation">Instrumentation API</a> 本质上还是基于 Gradle 原生的 <a target="_blank" rel="noopener" href="https://docs.gradle.org/5.3/javadoc/org/gradle/api/artifacts/transform/TransformAction.html">TransformAction</a>，正如前面的图所示，<a target="_blank" rel="noopener" href="https://docs.gradle.org/5.3/javadoc/org/gradle/api/artifacts/transform/TransformAction.html">TransformAction</a> 主要是用于 dependency Jar&#x2F;Classes 的 transform。</p>
<p>与 <a target="_blank" rel="noopener" href="https://docs.gradle.org/5.3/javadoc/org/gradle/api/artifacts/transform/TransformAction.html">TransformAction</a> API 不同的是，<a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.2/com/android/build/api/variant/Instrumentation">Instrumentation API</a> 做了一层类似于 Booster 的 <a target="_blank" rel="noopener" href="https://github.com/didi/booster/blob/master/booster-transform-spi/src/main/kotlin/com/didiglobal/booster/transform/Transformer.kt">Transformer</a> 的抽象，也就是 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.0/com/android/build/api/instrumentation/AsmClassVisitorFactory">AsmClassVisitorFactory</a>，通过它来创建 ASM 的 <code>ClassVisitor</code>。</p>
<img src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjI3NHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NDcwcHg7aGVpZ2h0OjI3NHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDQ3MCAyNzQiIHdpZHRoPSI0NzBweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1lbnRpdHkgY2xhc3Nlcy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJjbGFzc2VzIiBkYXRhLXNvdXJjZS1saW5lPSI1IiBkYXRhLXVpZD0iZW50MDAwMiIgaWQ9ImVudGl0eV9jbGFzc2VzIj48cmVjdCBmaWxsPSIjQzlGRkM5IiBoZWlnaHQ9IjUxLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEwMy4yMTM5IiB4PSI3IiB5PSIxNS43OSIvPjxpbWFnZSBoZWlnaHQ9IjE2IiB3aWR0aD0iMTYiIHg9IjUxLjEwNjkiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBUUNBWUFBQUFmOC85aEFBQUFRVWxFUVZSNFhtTmdHR3pnSHc1TU5QaDM4dm4yLzhnWUpBYkZSQUdzQmlBWlJCRGdOSUJZUTdBYWdBWGpCQmdHb0dPUUduUk55R0RVQUdvWVFDUWVSQUFBRC9rT2JPWCt0MlFBQUFBQVNVVk9SSzVDWUlJPSIgeT0iMjUuNzkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4My4yMTM5IiB4PSIxNyIgeT0iNTMuNzg1MSI+Q2xhc3Nlcy9KYXJzPC90ZXh0PjwvZz48IS0tZW50aXR5IGQ4LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9ImQ4IiBkYXRhLXNvdXJjZS1saW5lPSI2IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImVudGl0eV9kOCI+PHJlY3QgZmlsbD0iI0M5RkZDOSIgaGVpZ2h0PSI1MS4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIzOS42ODc1IiB4PSIzOTEuNzYiIHk9IjE1Ljc5Ii8+PGltYWdlIGhlaWdodD0iMTYiIHdpZHRoPSIxNiIgeD0iNDA0LjEwMzgiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBUUNBWUFBQUFmOC85aEFBQUFUVWxFUVZSNFhtTmdHQ3JnSDdvQXFRQmtBRVdHL0R2NWZQdC9FSTB1QVFNd0czQmlrQUg0RElFcklBYUQxRk5rQURaRFNESUFYVFBZQUVJWW4yWmlBTUZZSUFSZ0xpRWJVS1I1a0FNQVJUNnJxUzZjQTRzQUFBQUFTVVZPUks1Q1lJST0iIHk9IjI1Ljc5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTkuNjg3NSIgeD0iNDAxLjc2IiB5PSI1My43ODUxIj5EODwvdGV4dD48L2c+PCEtLWVudGl0eSB0Zi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJ0ZiIgZGF0YS1zb3VyY2UtbGluZT0iOCIgZGF0YS11aWQ9ImVudDAwMDQiIGlkPSJlbnRpdHlfdGYiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNjguODkwNiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMjExLjczNDQiIHg9IjE0NC43NCIgeT0iNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ5LjY2MzEiIHg9IjIzNC44NDM1IiB5PSIyOS45OTUxIj4mIzE3MTtUYXNrJiMxODc7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQuNDUwMiIgeD0iMTU0Ljc0IiB5PSI0Ni4yOTIiPiYjMTYwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxODcuMjg0MiIgeD0iMTU5LjE5MDIiIHk9IjYyLjU4ODkiPlRyYW5zZm9ybUNsYXNzZXNXaXRoQXNtPC90ZXh0PjwvZz48IS0tZW50aXR5IHcxLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IncxIiBkYXRhLXNvdXJjZS1saW5lPSI5IiBkYXRhLXVpZD0iZW50MDAwNSIgaWQ9ImVudGl0eV93MSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzNi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMTMuNzIwNyIgeD0iNDQuNzUiIHk9IjEzNS44OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkzLjcyMDciIHg9IjU0Ljc1IiB5PSIxNTguODg1MSI+V29ya0FjdGlvbiAxPC90ZXh0PjwvZz48IS0tZW50aXR5IHcyLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IncyIiBkYXRhLXNvdXJjZS1saW5lPSIxMCIgZGF0YS11aWQ9ImVudDAwMDYiIGlkPSJlbnRpdHlfdzIiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTEzLjcyMDciIHg9IjE5My43NSIgeT0iMTM1Ljg5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTMuNzIwNyIgeD0iMjAzLjc1IiB5PSIxNTguODg1MSI+V29ya0FjdGlvbiAyPC90ZXh0PjwvZz48IS0tZW50aXR5IHduLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9InduIiBkYXRhLXNvdXJjZS1saW5lPSIxMSIgZGF0YS11aWQ9ImVudDAwMDciIGlkPSJlbnRpdHlfd24iPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTIyLjM1NDUiIHg9IjM0Mi40MyIgeT0iMTM1Ljg5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTMuMzUwNiIgeD0iMzk2LjkzMiIgeT0iMTU4Ljg4NTEiPi4uLjwvdGV4dD48L2c+PCEtLWVudGl0eSBjdjEtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iY3YxIiBkYXRhLXNvdXJjZS1saW5lPSIxMiIgZGF0YS11aWQ9ImVudDAwMDgiIGlkPSJlbnRpdHlfY3YxIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjExNC42NTA0IiB4PSI0NC4yOCIgeT0iMjMyLjE4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTQuNjUwNCIgeD0iNTQuMjgiIHk9IjI1NS4xNzUxIj5DbGFzc1Zpc2l0b3IgMTwvdGV4dD48L2c+PCEtLWVudGl0eSBjdjItLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iY3YyIiBkYXRhLXNvdXJjZS1saW5lPSIxMyIgZGF0YS11aWQ9ImVudDAwMDkiIGlkPSJlbnRpdHlfY3YyIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjExNC42NTA0IiB4PSIxOTQuMjgiIHk9IjIzMi4xOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk0LjY1MDQiIHg9IjIwNC4yOCIgeT0iMjU1LjE3NTEiPkNsYXNzVmlzaXRvciAyPC90ZXh0PjwvZz48IS0tZW50aXR5IGN2bi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJjdm4iIGRhdGEtc291cmNlLWxpbmU9IjE0IiBkYXRhLXVpZD0iZW50MDAxMCIgaWQ9ImVudGl0eV9jdm4iPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTE3LjkwNDMiIHg9IjM0My42NSIgeT0iMjMyLjE4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTMuMzUwNiIgeD0iMzkzLjcwMTgiIHk9IjI1NS4xNzUxIj4uLi48L3RleHQ+PC9nPjwhLS1saW5rIGNsYXNzZXMgdG8gdGYtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iY2xhc3NlcyIgZGF0YS1lbnRpdHktMj0idGYiIGRhdGEtc291cmNlLWxpbmU9IjE2IiBkYXRhLXVpZD0ibG5rMTEiIGlkPSJsaW5rX2NsYXNzZXNfdGYiPjxwYXRoIGQ9Ik0xMTAuMzYsNDEuNDQgQzEyMS42OCw0MS40NCAxMjcsNDEuNDQgMTM4LjMyLDQxLjQ0IiBmaWxsPSJub25lIiBpZD0iY2xhc3Nlcy10by10ZiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTQ0LjMyLDQxLjQ0LDEzNS4zMiwzNy40NCwxMzkuMzIsNDEuNDQsMTM1LjMyLDQ1LjQ0LDE0NC4zMiw0MS40NCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB0ZiB0byB3MS0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJ0ZiIgZGF0YS1lbnRpdHktMj0idzEiIGRhdGEtc291cmNlLWxpbmU9IjE3IiBkYXRhLXVpZD0ibG5rMTIiIGlkPSJsaW5rX3RmX3cxIj48cGF0aCBkPSJNMjA1LjA5LDc2LjIyIEMxNzguNzMsOTUuNzkgMTUxLjQ1NzUsMTE2LjAzMzUgMTMwLjA2NzUsMTMxLjkxMzUiIGZpbGw9Im5vbmUiIGlkPSJ0Zi10by13MSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTI1LjI1LDEzNS40OSwxMzQuODYwNiwxMzMuMzM2OSwxMjkuMjY0NiwxMzIuNTA5NiwxMzAuMDkxOSwxMjYuOTEzNSwxMjUuMjUsMTM1LjQ5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmIHRvIHcyLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InRmIiBkYXRhLWVudGl0eS0yPSJ3MiIgZGF0YS1zb3VyY2UtbGluZT0iMTgiIGRhdGEtdWlkPSJsbmsxMyIgaWQ9ImxpbmtfdGZfdzIiPjxwYXRoIGQ9Ik0yNTAuNjEsNzYuMjIgQzI1MC42MSw5NS43OSAyNTAuNjEsMTEzLjYxIDI1MC42MSwxMjkuNDkiIGZpbGw9Im5vbmUiIGlkPSJ0Zi10by13MiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjUwLjYxLDEzNS40OSwyNTQuNjEsMTI2LjQ5LDI1MC42MSwxMzAuNDksMjQ2LjYxLDEyNi40OSwyNTAuNjEsMTM1LjQ5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmIHRvIHduLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InRmIiBkYXRhLWVudGl0eS0yPSJ3biIgZGF0YS1zb3VyY2UtbGluZT0iMTkiIGRhdGEtdWlkPSJsbmsxNCIgaWQ9ImxpbmtfdGZfd24iPjxwYXRoIGQ9Ik0yOTcuMzQsNzYuMjIgQzMyNC40MSw5NS43OSAzNTIuNTA4LDExNi4wOTQxIDM3NC40NjgsMTMxLjk3NDEiIGZpbGw9Im5vbmUiIGlkPSJ0Zi10by13biIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMzc5LjMzLDEzNS40OSwzNzQuMzgwOSwxMjYuOTc0OSwzNzUuMjc4NCwxMzIuNTYwMSwzNjkuNjkzMSwxMzMuNDU3NSwzNzkuMzMsMTM1LjQ5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmIHRvIGQ4LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InRmIiBkYXRhLWVudGl0eS0yPSJkOCIgZGF0YS1zb3VyY2UtbGluZT0iMjAiIGRhdGEtdWlkPSJsbmsxNSIgaWQ9ImxpbmtfdGZfZDgiPjxwYXRoIGQ9Ik0zNTYuODksNDEuNDQgQzM2OC40Myw0MS40NCAzNzMuOTcsNDEuNDQgMzg1LjUyLDQxLjQ0IiBmaWxsPSJub25lIiBpZD0idGYtdG8tZDgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjM5MS41Miw0MS40NCwzODIuNTIsMzcuNDQsMzg2LjUyLDQxLjQ0LDM4Mi41Miw0NS40NCwzOTEuNTIsNDEuNDQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgdzEgdG8gY3YxLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IncxIiBkYXRhLWVudGl0eS0yPSJjdjEiIGRhdGEtc291cmNlLWxpbmU9IjIxIiBkYXRhLXVpZD0ibG5rMTYiIGlkPSJsaW5rX3cxX2N2MSI+PHBhdGggZD0iTTEwMS42MSwxNzIuMzMgQzEwMS42MSwxODkuMjQgMTAxLjYxLDIwOC44NSAxMDEuNjEsMjI1LjgzIiBmaWxsPSJub25lIiBpZD0idzEtdG8tY3YxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxMDEuNjEsMjMxLjgzLDEwNS42MSwyMjIuODMsMTAxLjYxLDIyNi44Myw5Ny42MSwyMjIuODMsMTAxLjYxLDIzMS44MyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB3MSB0byBjdjItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0idzEiIGRhdGEtZW50aXR5LTI9ImN2MiIgZGF0YS1zb3VyY2UtbGluZT0iMjIiIGRhdGEtdWlkPSJsbmsxNyIgaWQ9ImxpbmtfdzFfY3YyIj48cGF0aCBkPSJNMTI5LjQ3LDE3Mi41NSBDMTU2LjMzLDE4OS40MyAxOTEuNjcwOCwyMTEuNjQ1OSAyMTguNTYwOCwyMjguNTU1OSIgZmlsbD0ibm9uZSIgaWQ9IncxLXRvLWN2MiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjIzLjY0LDIzMS43NSwyMTguMTUwNiwyMjMuNTcyOCwyMTkuNDA3NCwyMjkuMDg4MywyMTMuODkxOSwyMzAuMzQ1LDIyMy42NCwyMzEuNzUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgdzEgdG8gY3ZuLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IncxIiBkYXRhLWVudGl0eS0yPSJjdm4iIGRhdGEtc291cmNlLWxpbmU9IjIzIiBkYXRhLXVpZD0ibG5rMTgiIGlkPSJsaW5rX3cxX2N2biI+PHBhdGggZD0iTTE1Ny44NywxNzIuNjYgQzIxMS43MiwxODkuNTMgMjg2Ljc5NDQsMjEzLjA0NjMgMzQwLjY0NDQsMjI5LjkxNjMiIGZpbGw9Im5vbmUiIGlkPSJ3MS10by1jdm4iIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjM0Ni4zNywyMzEuNzEsMzM4Ljk3NzQsMjI1LjIwMjQsMzQxLjU5ODcsMjMwLjIxNTIsMzM2LjU4NTgsMjMyLjgzNjUsMzQ2LjM3LDIzMS43MSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB3MiB0byBjdjEtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0idzIiIGRhdGEtZW50aXR5LTI9ImN2MSIgZGF0YS1zb3VyY2UtbGluZT0iMjQiIGRhdGEtdWlkPSJsbmsxOSIgaWQ9ImxpbmtfdzJfY3YxIj48cGF0aCBkPSJNMjIyLjkzLDE3Mi41NSBDMTk2LjI1LDE4OS40MyAxNjEuMTY5NSwyMTEuNjMwNSAxMzQuNDU5NSwyMjguNTQwNSIgZmlsbD0ibm9uZSIgaWQ9IncyLXRvLWN2MSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTI5LjM5LDIzMS43NSwxMzkuMTMzOCwyMzAuMzE1NSwxMzMuNjE0NSwyMjkuMDc1NSwxMzQuODU0NiwyMjMuNTU2MiwxMjkuMzksMjMxLjc1IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHcyIHRvIGN2Mi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJ3MiIgZGF0YS1lbnRpdHktMj0iY3YyIiBkYXRhLXNvdXJjZS1saW5lPSIyNSIgZGF0YS11aWQ9ImxuazIwIiBpZD0ibGlua193Ml9jdjIiPjxwYXRoIGQ9Ik0yNTAuNzksMTcyLjMzIEMyNTAuOTcsMTg5LjI0IDI1MS4xNzY0LDIwOC44NTAzIDI1MS4zNTY0LDIyNS44MzAzIiBmaWxsPSJub25lIiBpZD0idzItdG8tY3YyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIyNTEuNDIsMjMxLjgzLDI1NS4zMjQ0LDIyMi43ODgxLDI1MS4zNjcsMjI2LjgzMDMsMjQ3LjMyNDgsMjIyLjg3MjksMjUxLjQyLDIzMS44MyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB3MiB0byBjdm4tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0idzIiIGRhdGEtZW50aXR5LTI9ImN2biIgZGF0YS1zb3VyY2UtbGluZT0iMjYiIGRhdGEtdWlkPSJsbmsyMSIgaWQ9ImxpbmtfdzJfY3ZuIj48cGF0aCBkPSJNMjc4Ljg0LDE3Mi41NSBDMzA2LjA2LDE4OS40MyAzNDEuOTIxOCwyMTEuNjc2MyAzNjkuMTcxOCwyMjguNTg2MyIgZmlsbD0ibm9uZSIgaWQ9IncyLXRvLWN2biIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMzc0LjI3LDIzMS43NSwzNjguNzMxOSwyMjMuNjA1NywzNzAuMDIxNSwyMjkuMTEzNiwzNjQuNTEzNywyMzAuNDAzMywzNzQuMjcsMjMxLjc1IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHduIHRvIGN2MS0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJ3biIgZGF0YS1lbnRpdHktMj0iY3YxIiBkYXRhLXNvdXJjZS1saW5lPSIyNyIgZGF0YS11aWQ9ImxuazIyIiBpZD0ibGlua193bl9jdjEiPjxwYXRoIGQ9Ik0zNDcuMTYsMTcyLjY2IEMyOTMuMTIsMTg5LjUzIDIxNy43ODcyLDIxMy4wNTE0IDE2My43NjcyLDIyOS45MjE0IiBmaWxsPSJub25lIiBpZD0id24tdG8tY3YxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxNTguMDQsMjMxLjcxLDE2Ny44MjMyLDIzMi44NDUzLDE2Mi44MTI3LDIzMC4yMTk1LDE2NS40Mzg1LDIyNS4yMDksMTU4LjA0LDIzMS43MSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB3biB0byBjdjItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0id24iIGRhdGEtZW50aXR5LTI9ImN2MiIgZGF0YS1zb3VyY2UtbGluZT0iMjgiIGRhdGEtdWlkPSJsbmsyMyIgaWQ9Imxpbmtfd25fY3YyIj48cGF0aCBkPSJNMzc1LjM3LDE3Mi41NSBDMzQ4LjE2LDE4OS40MyAzMTIuMjk4MiwyMTEuNjc2MyAyODUuMDQ4MiwyMjguNTg2MyIgZmlsbD0ibm9uZSIgaWQ9InduLXRvLWN2MiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjc5Ljk1LDIzMS43NSwyODkuNzA2MywyMzAuNDAzMywyODQuMTk4NSwyMjkuMTEzNiwyODUuNDg4MSwyMjMuNjA1NywyNzkuOTUsMjMxLjc1IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHduIHRvIGN2bi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJ3biIgZGF0YS1lbnRpdHktMj0iY3ZuIiBkYXRhLXNvdXJjZS1saW5lPSIyOSIgZGF0YS11aWQ9ImxuazI0IiBpZD0ibGlua193bl9jdm4iPjxwYXRoIGQ9Ik00MDMuNDIsMTcyLjMzIEM0MDMuMjQsMTg5LjI0IDQwMy4wMzM2LDIwOC44NTAzIDQwMi44NTM2LDIyNS44MzAzIiBmaWxsPSJub25lIiBpZD0id24tdG8tY3ZuIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI0MDIuNzksMjMxLjgzLDQwNi44ODUyLDIyMi44NzI5LDQwMi44NDMsMjI2LjgzMDMsMzk4Ljg4NTYsMjIyLjc4ODEsNDAyLjc5LDIzMS44MyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tU1JDPVtUUDBuUXlDbTQ4THRfT2gzZFVxSUdTNjNDOEhhd1hvUTlTakxMYzlYLW5IRWdhQ2ZfVXpMZDNRTTdRaGZJVlZUdFRGcGhRS3BDbFIwSFdVYUtzVUtVWlNEM2pQbkxTNk5XN1pPVkwyelNLbzZHUnc4Um82R1RNRHgzMFFVVGFPdHYzZnQtZUhpcXc3dG5aLV84bGlDcThFLUZPMUl1T3hib0M0VUtPVWctY19FalhveHd0QlVVNlFkWlZVbkp6cGpHWlhVcUdtVVpiOHh6NnR5bjg0RTEzajZ5YVY3X1FfN2xHdERzbFRQQ2tjbzZZVmo3UlRoN1FtWk1DdEFTYmNNaXA4alYxSDVDTHJJS1ctdEhRRUpELWpqUzNuVmZHVnZJQ1d2aUxZdHMyUi1haXl2aHM5NjhpUUtycjVVTGZFS2F3SEhOamN3NTM2OHlKS1FKUkhDRDhjT25pSjhYOTQ5R21iMzJORk56MEMwXS0tPjwvZz48L3N2Zz4='>

<p>理论上，Booster 通过 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.2/com/android/build/api/variant/Instrumentation">Instrumentation API</a> 也是可以解决 transform 的问题，只需要将 <a target="_blank" rel="noopener" href="https://github.com/didi/booster/blob/master/booster-transform-spi/src/main/kotlin/com/didiglobal/booster/transform/Transformer.kt">Transformer</a> 实现一下 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.0/com/android/build/api/instrumentation/AsmClassVisitorFactory">AsmClassVisitorFactory</a> 接口就行了：</p>
<img src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjI3NHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NTEzcHg7aGVpZ2h0OjI3NHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDUxMyAyNzQiIHdpZHRoPSI1MTNweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1lbnRpdHkgY2xhc3Nlcy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJjbGFzc2VzIiBkYXRhLXNvdXJjZS1saW5lPSI1IiBkYXRhLXVpZD0iZW50MDAwMiIgaWQ9ImVudGl0eV9jbGFzc2VzIj48cmVjdCBmaWxsPSIjQzlGRkM5IiBoZWlnaHQ9IjUxLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEwMy4yMTM5IiB4PSIzMi42NCIgeT0iMTUuNzkiLz48aW1hZ2UgaGVpZ2h0PSIxNiIgd2lkdGg9IjE2IiB4PSI3Ni43NDY5IiB4bGluazpocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQVFDQVlBQUFBZjgvOWhBQUFBUVVsRVFWUjRYbU5nR0d6Z0h3NU1OUGgzOHZuMi84Z1lKQWJGUkFHc0JpQVpSQkRnTklCWVE3QWFnQVhqQkJnR29HT1FHblJOeUdEVUFHb1lRQ1FlUkFBQUQva09iT1grdDJRQUFBQUFTVVZPUks1Q1lJST0iIHk9IjI1Ljc5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuMjEzOSIgeD0iNDIuNjQiIHk9IjUzLjc4NTEiPkNsYXNzZXMvSmFyczwvdGV4dD48L2c+PCEtLWVudGl0eSBkOC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJkOCIgZGF0YS1zb3VyY2UtbGluZT0iNiIgZGF0YS11aWQ9ImVudDAwMDMiIGlkPSJlbnRpdHlfZDgiPjxyZWN0IGZpbGw9IiNDOUZGQzkiIGhlaWdodD0iNTEuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMzkuNjg3NSIgeD0iNDE3LjQxIiB5PSIxNS43OSIvPjxpbWFnZSBoZWlnaHQ9IjE2IiB3aWR0aD0iMTYiIHg9IjQyOS43NTM4IiB4bGluazpocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQVFDQVlBQUFBZjgvOWhBQUFBVFVsRVFWUjRYbU5nR0NyZ0g3b0FxUUJrQUVXRy9EdjVmUHQvRUkwdUFRTXdHM0Jpa0FINERJRXJJQWFEMUZOa0FEWkRTRElBWFRQWUFFSVluMlppQU1GWUlBUmdMaUViVUtSNWtBTUFSVDZycVM2Y0E0c0FBQUFBU1VWT1JLNUNZSUk9IiB5PSIyNS43OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE5LjY4NzUiIHg9IjQyNy40MSIgeT0iNTMuNzg1MSI+RDg8L3RleHQ+PC9nPjwhLS1lbnRpdHkgdGYtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0idGYiIGRhdGEtc291cmNlLWxpbmU9IjgiIGRhdGEtdWlkPSJlbnQwMDA0IiBpZD0iZW50aXR5X3RmIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjY4Ljg5MDYiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjIxMS43MzQ0IiB4PSIxNzAuMzgiIHk9IjciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0OS42NjMxIiB4PSIyNjAuNDgzNSIgeT0iMjkuOTk1MSI+JiMxNzE7VGFzayYjMTg3OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0LjQ1MDIiIHg9IjE4MC4zOCIgeT0iNDYuMjkyIj4mIzE2MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTg3LjI4NDIiIHg9IjE4NC44MzAyIiB5PSI2Mi41ODg5Ij5UcmFuc2Zvcm1DbGFzc2VzV2l0aEFzbTwvdGV4dD48L2c+PCEtLWVudGl0eSB3MS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJ3MSIgZGF0YS1zb3VyY2UtbGluZT0iOSIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJlbnRpdHlfdzEiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTEzLjcyMDciIHg9IjcwLjM5IiB5PSIxMzUuODkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5My43MjA3IiB4PSI4MC4zOSIgeT0iMTU4Ljg4NTEiPldvcmtBY3Rpb24gMTwvdGV4dD48L2c+PCEtLWVudGl0eSB3Mi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJ3MiIgZGF0YS1zb3VyY2UtbGluZT0iMTAiIGRhdGEtdWlkPSJlbnQwMDA2IiBpZD0iZW50aXR5X3cyIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjExMy43MjA3IiB4PSIyMTkuMzkiIHk9IjEzNS44OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkzLjcyMDciIHg9IjIyOS4zOSIgeT0iMTU4Ljg4NTEiPldvcmtBY3Rpb24gMjwvdGV4dD48L2c+PCEtLWVudGl0eSB3bi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJ3biIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGRhdGEtdWlkPSJlbnQwMDA3IiBpZD0iZW50aXR5X3duIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEyMi4zNTQ1IiB4PSIzNjguMDciIHk9IjEzNS44OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzLjM1MDYiIHg9IjQyMi41NzIiIHk9IjE1OC44ODUxIj4uLi48L3RleHQ+PC9nPjwhLS1lbnRpdHkgY3YxLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9ImN2MSIgZGF0YS1zb3VyY2UtbGluZT0iMTIiIGRhdGEtdWlkPSJlbnQwMDA4IiBpZD0iZW50aXR5X2N2MSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzNi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNTYuNSIgeD0iNyIgeT0iMjMyLjE4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM2LjUiIHg9IjE3IiB5PSIyNTUuMTc1MSI+Q2xhc3NUcmFuc2Zvcm1lciAxPC90ZXh0PjwvZz48IS0tZW50aXR5IGN2Mi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJjdjIiIGRhdGEtc291cmNlLWxpbmU9IjEzIiBkYXRhLXVpZD0iZW50MDAwOSIgaWQ9ImVudGl0eV9jdjIiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTU2LjUiIHg9IjE5OCIgeT0iMjMyLjE4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM2LjUiIHg9IjIwOCIgeT0iMjU1LjE3NTEiPkNsYXNzVHJhbnNmb3JtZXIgMjwvdGV4dD48L2c+PCEtLWVudGl0eSBjdm4tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iY3ZuIiBkYXRhLXNvdXJjZS1saW5lPSIxNCIgZGF0YS11aWQ9ImVudDAwMTAiIGlkPSJlbnRpdHlfY3ZuIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjExNy45MDQzIiB4PSIzODkuMyIgeT0iMjMyLjE4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTMuMzUwNiIgeD0iNDM5LjM1MTgiIHk9IjI1NS4xNzUxIj4uLi48L3RleHQ+PC9nPjwhLS1saW5rIGNsYXNzZXMgdG8gdGYtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iY2xhc3NlcyIgZGF0YS1lbnRpdHktMj0idGYiIGRhdGEtc291cmNlLWxpbmU9IjE2IiBkYXRhLXVpZD0ibG5rMTEiIGlkPSJsaW5rX2NsYXNzZXNfdGYiPjxwYXRoIGQ9Ik0xMzYsNDEuNDQgQzE0Ny4zMiw0MS40NCAxNTIuNjQsNDEuNDQgMTYzLjk3LDQxLjQ0IiBmaWxsPSJub25lIiBpZD0iY2xhc3Nlcy10by10ZiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTY5Ljk3LDQxLjQ0LDE2MC45NywzNy40NCwxNjQuOTcsNDEuNDQsMTYwLjk3LDQ1LjQ0LDE2OS45Nyw0MS40NCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB0ZiB0byB3MS0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJ0ZiIgZGF0YS1lbnRpdHktMj0idzEiIGRhdGEtc291cmNlLWxpbmU9IjE3IiBkYXRhLXVpZD0ibG5rMTIiIGlkPSJsaW5rX3RmX3cxIj48cGF0aCBkPSJNMjMwLjc0LDc2LjIyIEMyMDQuMzgsOTUuNzkgMTc3LjA5NzUsMTE2LjAzMzUgMTU1LjcwNzUsMTMxLjkxMzUiIGZpbGw9Im5vbmUiIGlkPSJ0Zi10by13MSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTUwLjg5LDEzNS40OSwxNjAuNTAwNiwxMzMuMzM2OSwxNTQuOTA0NiwxMzIuNTA5NiwxNTUuNzMxOSwxMjYuOTEzNSwxNTAuODksMTM1LjQ5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmIHRvIHcyLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InRmIiBkYXRhLWVudGl0eS0yPSJ3MiIgZGF0YS1zb3VyY2UtbGluZT0iMTgiIGRhdGEtdWlkPSJsbmsxMyIgaWQ9ImxpbmtfdGZfdzIiPjxwYXRoIGQ9Ik0yNzYuMjUsNzYuMjIgQzI3Ni4yNSw5NS43OSAyNzYuMjUsMTEzLjYxIDI3Ni4yNSwxMjkuNDkiIGZpbGw9Im5vbmUiIGlkPSJ0Zi10by13MiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjc2LjI1LDEzNS40OSwyODAuMjUsMTI2LjQ5LDI3Ni4yNSwxMzAuNDksMjcyLjI1LDEyNi40OSwyNzYuMjUsMTM1LjQ5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmIHRvIHduLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InRmIiBkYXRhLWVudGl0eS0yPSJ3biIgZGF0YS1zb3VyY2UtbGluZT0iMTkiIGRhdGEtdWlkPSJsbmsxNCIgaWQ9ImxpbmtfdGZfd24iPjxwYXRoIGQ9Ik0zMjIuOTksNzYuMjIgQzM1MC4wNSw5NS43OSAzNzguMTQ3MywxMTYuMDk1MiA0MDAuMTE3MywxMzEuOTc1MiIgZmlsbD0ibm9uZSIgaWQ9InRmLXRvLXduIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI0MDQuOTgsMTM1LjQ5LDQwMC4wMjkxLDEyNi45NzYsNDAwLjkyNzcsMTMyLjU2MSwzOTUuMzQyNywxMzMuNDU5Niw0MDQuOTgsMTM1LjQ5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHRmIHRvIGQ4LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InRmIiBkYXRhLWVudGl0eS0yPSJkOCIgZGF0YS1zb3VyY2UtbGluZT0iMjAiIGRhdGEtdWlkPSJsbmsxNSIgaWQ9ImxpbmtfdGZfZDgiPjxwYXRoIGQ9Ik0zODIuNTQsNDEuNDQgQzM5NC4wOCw0MS40NCAzOTkuNjIsNDEuNDQgNDExLjE2LDQxLjQ0IiBmaWxsPSJub25lIiBpZD0idGYtdG8tZDgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjQxNy4xNiw0MS40NCw0MDguMTYsMzcuNDQsNDEyLjE2LDQxLjQ0LDQwOC4xNiw0NS40NCw0MTcuMTYsNDEuNDQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgdzEgdG8gY3YxLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IncxIiBkYXRhLWVudGl0eS0yPSJjdjEiIGRhdGEtc291cmNlLWxpbmU9IjIxIiBkYXRhLXVpZD0ibG5rMTYiIGlkPSJsaW5rX3cxX2N2MSI+PHBhdGggZD0iTTExOS41NSwxNzIuMzMgQzExMi4wMiwxODkuMjQgMTAzLjA1MDQsMjA5LjM2ODcgOTUuNDkwNCwyMjYuMzQ4NyIgZmlsbD0ibm9uZSIgaWQ9IncxLXRvLWN2MSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iOTMuMDUsMjMxLjgzLDEwMC4zNjQ4LDIyNS4yMzUsOTUuMDgzNywyMjcuMjYyMyw5My4wNTY1LDIyMS45ODExLDkzLjA1LDIzMS44MyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB3MSB0byBjdjItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0idzEiIGRhdGEtZW50aXR5LTI9ImN2MiIgZGF0YS1zb3VyY2UtbGluZT0iMjIiIGRhdGEtdWlkPSJsbmsxNyIgaWQ9ImxpbmtfdzFfY3YyIj48cGF0aCBkPSJNMTU0LjkzLDE3Mi41NSBDMTgxLjYxLDE4OS40MyAyMTYuNjkwNSwyMTEuNjMwNSAyNDMuNDAwNSwyMjguNTQwNSIgZmlsbD0ibm9uZSIgaWQ9IncxLXRvLWN2MiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjQ4LjQ3LDIzMS43NSwyNDMuMDA1NCwyMjMuNTU2MiwyNDQuMjQ1NSwyMjkuMDc1NSwyMzguNzI2MiwyMzAuMzE1NSwyNDguNDcsMjMxLjc1IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHcxIHRvIGN2bi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJ3MSIgZGF0YS1lbnRpdHktMj0iY3ZuIiBkYXRhLXNvdXJjZS1saW5lPSIyMyIgZGF0YS11aWQ9ImxuazE4IiBpZD0ibGlua193MV9jdm4iPjxwYXRoIGQ9Ik0xODQuMjcsMTcxLjc4IEMyNDEuOTIsMTg4LjcyIDMyNC44NjMxLDIxMy4wODkzIDM4My4yOTMxLDIzMC4yNDkzIiBmaWxsPSJub25lIiBpZD0idzEtdG8tY3ZuIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzODkuMDUsMjMxLjk0LDM4MS41NDE4LDIyNS41NjYsMzg0LjI1MjYsMjMwLjUzMTEsMzc5LjI4NzYsMjMzLjI0MTksMzg5LjA1LDIzMS45NCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB3MiB0byBjdjEtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0idzIiIGRhdGEtZW50aXR5LTI9ImN2MSIgZGF0YS1zb3VyY2UtbGluZT0iMjQiIGRhdGEtdWlkPSJsbmsxOSIgaWQ9ImxpbmtfdzJfY3YxIj48cGF0aCBkPSJNMjQwLjc3LDE3Mi41NSBDMjA2LjU3LDE4OS40MyAxNjAuNDksMjEyLjE4MzggMTI2LjI0LDIyOS4wOTM4IiBmaWxsPSJub25lIiBpZD0idzItdG8tY3YxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxMjAuODYsMjMxLjc1LDEzMC43MDA4LDIzMS4zNTIzLDEyNS4zNDMzLDIyOS41MzY1LDEyNy4xNTkyLDIyNC4xNzksMTIwLjg2LDIzMS43NSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB3MiB0byBjdjItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0idzIiIGRhdGEtZW50aXR5LTI9ImN2MiIgZGF0YS1zb3VyY2UtbGluZT0iMjUiIGRhdGEtdWlkPSJsbmsyMCIgaWQ9ImxpbmtfdzJfY3YyIj48cGF0aCBkPSJNMjc2LjI1LDE3Mi4zMyBDMjc2LjI1LDE4OS4yNCAyNzYuMjUsMjA4Ljg1IDI3Ni4yNSwyMjUuODMiIGZpbGw9Im5vbmUiIGlkPSJ3Mi10by1jdjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjI3Ni4yNSwyMzEuODMsMjgwLjI1LDIyMi44MywyNzYuMjUsMjI2LjgzLDI3Mi4yNSwyMjIuODMsMjc2LjI1LDIzMS44MyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB3MiB0byBjdm4tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0idzIiIGRhdGEtZW50aXR5LTI9ImN2biIgZGF0YS1zb3VyY2UtbGluZT0iMjYiIGRhdGEtdWlkPSJsbmsyMSIgaWQ9ImxpbmtfdzJfY3ZuIj48cGF0aCBkPSJNMzA4LjIsMTcyLjU1IEMzMzksMTg5LjQzIDM4MC4wNzksMjExLjk1NTMgNDEwLjkxOSwyMjguODY1MyIgZmlsbD0ibm9uZSIgaWQ9IncyLXRvLWN2biIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNDE2LjE4LDIzMS43NSw0MTAuMjExNiwyMjMuOTE1Niw0MTEuNzk1OCwyMjkuMzQ2MSw0MDYuMzY1MywyMzAuOTMwMyw0MTYuMTgsMjMxLjc1IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHduIHRvIGN2MS0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJ3biIgZGF0YS1lbnRpdHktMj0iY3YxIiBkYXRhLXNvdXJjZS1saW5lPSIyNyIgZGF0YS11aWQ9ImxuazIyIiBpZD0ibGlua193bl9jdjEiPjxwYXRoIGQ9Ik0zNjcuNzUsMTcxLjg5IEMzMDYuMiwxODguNzcgMjE3LjY5NjUsMjEzLjAyMzUgMTU1LjIxNjUsMjMwLjE1MzUiIGZpbGw9Im5vbmUiIGlkPSJ3bi10by1jdjEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE0OS40MywyMzEuNzQsMTU5LjE2NzMsMjMzLjIxNzksMTU0LjI1MjEsMjMwLjQxNzksMTU3LjA1MjEsMjI1LjUwMjcsMTQ5LjQzLDIzMS43NCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayB3biB0byBjdjItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0id24iIGRhdGEtZW50aXR5LTI9ImN2MiIgZGF0YS1zb3VyY2UtbGluZT0iMjgiIGRhdGEtdWlkPSJsbmsyMyIgaWQ9Imxpbmtfd25fY3YyIj48cGF0aCBkPSJNNDAwLjgzLDE3Mi41NSBDMzczLjQ0LDE4OS40MyAzMzcuMzE3NSwyMTEuNjkxNCAzMDkuODg3NSwyMjguNjAxNCIgZmlsbD0ibm9uZSIgaWQ9InduLXRvLWN2MiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMzA0Ljc4LDIzMS43NSwzMTQuNTQwMywyMzAuNDMyLDMwOS4wMzYyLDIyOS4xMjYxLDMxMC4zNDIxLDIyMy42MjIxLDMwNC43OCwyMzEuNzUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgd24gdG8gY3ZuLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InduIiBkYXRhLWVudGl0eS0yPSJjdm4iIGRhdGEtc291cmNlLWxpbmU9IjI5IiBkYXRhLXVpZD0ibG5rMjQiIGlkPSJsaW5rX3duX2N2biI+PHBhdGggZD0iTTQzMi43MywxNzIuMzMgQzQzNi4xNCwxODkuMjQgNDQwLjExNTMsMjA4Ljk2ODEgNDQzLjUzNTMsMjI1Ljk0ODEiIGZpbGw9Im5vbmUiIGlkPSJ3bi10by1jdm4iIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjQ0NC43MiwyMzEuODMsNDQ2Ljg2NDIsMjIyLjIxNzQsNDQzLjczMjgsMjI2LjkyODQsNDM5LjAyMTcsMjIzLjc5Nyw0NDQuNzIsMjMxLjgzIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1TUkM9W1RQNG5SdUNtNDhMdF91ZUpkUTcyS1lLNlgxSWJLc1VhQjVja25XR0JFNFRkRHI1THpSX044SXFPc2Rmdy1Cd3hVdHd1dGowUDZLVFdoSnBJUVQxYi1RZXhsMVpCTEdLVjBpOVgtcVJEdFo5ZjFsYWFGZUwwTGZxUHFNanVnQk5nbzB4c3oweDlWYTNkajdqeUdOTzllMERybHUyb3ozRU04ZGxKZWw5THpULVN2c0JnUmVmcnV2Y2pxaXc1Rlo3UjFUX1VxMEgtZFJBaXFWTlg0S1N3NGpJQ3Y1aEJ1eFY3V183VHBlcjlERWNRSnZDRWJsa1R5aU9JdkFrb3Q5UmJnYW1SN3JjTUJIeW5nSXh0SFBFSnNMVjhEYnpKeWN6QWhnZERzaXJNeVZDN0thd2hhOUs4U1FMRGFEVHlhTkFIRENhUnNuR1kxM0JUMWlFSGJmNGM0TDlQNjFhbkNjOGVPWVhZUGFyVl0tLT48L2c+PC9zdmc+'>

<h2 id="Trade-off"><a href="#Trade-off" class="headerlink" title="Trade-off"></a>Trade-off</h2><p>从技术的角度来看，无论是 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.2/com/android/build/api/variant/Instrumentation">Instrumentation API</a> 还是 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/4.1/com/android/build/api/artifact/Artifacts">Artifacts API</a>，都可以解决 transform 的问题，但 Booster 所以考虑的不仅仅是如何实现的问题，我们可以通过下面的表格来对比一下二者之间的优缺点：</p>
<table>
<thead>
<tr>
<th>Solution</th>
<th>Instrumentation API</th>
<th>Artifacts API</th>
</tr>
</thead>
<tbody><tr>
<td>Pros</td>
<td><ul><li>可减少一次读写 jars&#x2F;classes 的 I&#x2F;O</li><li>可作用于 Configuration Cache (实际效果待测试) </li></ul></td>
<td><ul><li>不受字节码框架限制，可以同时支持 ASM 和 Javassist</li><li>Transform 可以完全摆脱对 Gradle API 的依赖</li><li>开发者迁移成本较低</li></ul></td>
</tr>
<tr>
<td>Cons</td>
<td><ul><li>只能支持 ASM，不支持 Javassist</li><li>CHA 只能使用 AGP 的 API，而且功能很弱</li><li>严重依赖 Gradle API，不能脱离 Gradle 单独使用，跟 Booster 最初的设计理念不符</li><li>开发者迁移成本较高</li></ul></td>
<td><ul><li>多一个 Task，多一次 I&#x2F;O</li><li>不能作用于 Configuration Cache </li></ul></td>
</tr>
</tbody></table>
<p>综上分析，我们更倾向于采用 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/4.1/com/android/build/api/artifact/Artifacts">Artifacts API</a> 的方案来实现，尽管跟 <a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.2/com/android/build/api/variant/Instrumentation">Instrumentation API</a> 相比，对 Gradle 的 cache 支持得更好，但很多功能受限于 AGP 目前的实现，以我们对 Booster 的使用者的了解，<a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.2/com/android/build/api/variant/Instrumentation">Instrumentation API</a> 目前的能力远不能满足开发者的需求，尤其是对 AGP 构建的中间产物有依赖的案例，<a target="_blank" rel="noopener" href="https://developer.android.com/reference/tools/gradle-api/7.2/com/android/build/api/variant/Instrumentation">Instrumentation API</a> 实现起来相当麻烦。所以，Booster 更多的站在开发者的角度来考虑问题——在功能尽可能不打折扣的情况下，用更低的迁移成本。</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://android-developers.googleblog.com/2022/10/prepare-your-android-project-for-agp8-changes.html">https://android-developers.googleblog.com/2022/10/prepare-your-android-project-for-agp8-changes.html</a></li>
<li><a target="_blank" rel="noopener" href="http://tools.android.com/tech-docs/new-build-system">http://tools.android.com/tech-docs/new-build-system</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.gradle.org/5.3/release-notes.html">https://docs.gradle.org/5.3/release-notes.html</a></li>
</ul>
</div><iframe src="/donate/?AliPayQR=/img/AliPayQR.png&amp;WeChatQR=/img/WeChatQR.png&amp;GitHub=undefined&amp;BTCQR=undefined&amp;BTCKEY=undefined&amp;PayPal=undefined" style="overflow-x:hidden; overflow-y:hidden; border:0xp none #fff; min-height:300px; width:100%;" frameborder="0" scrolling="no"></iframe><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>johnsonlee</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2023/05/29/how-booster-supports-agp-8/">https://johnsonlee.io/2023/05/29/how-booster-supports-agp-8/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</li></ul></div><br><div class="tags"></div><div class="post-nav"><a class="pre" href="/2023/09/04/booster-v4-16-3-released/">Booster 4.16.3 版本发布</a><a class="next" href="/2023/05/28/booster-v4-16-2-released/">Booster 4.16.2 版本发布</a></div><script type="text/javascript" id="diffblog-plugin-script" async="false" src="https://diff.blog/static/js/diffblog_plugin_v1.js"></script><script>document.getElementById("diffblog-plugin-script").addEventListener('load', () => {
  DiffBlog('0jhfofmazizsde2k5pw64l8p2sy592xanbfvhtabsoy93kenap');
});
</script><div id="container"></div><link rel="preload" type="text/css" href="/libs/gitalk/1.7.2/gitalk.css" as="style" onload="this.rel=&quot;stylesheet&quot;"><script>(function() {
  load(
    '/libs/blueimp-md5/2.10.0/js/md5.js',
    '/libs/gitalk/1.7.2/gitalk.min.js'
  ).then(() => {
    var gitalk = new Gitalk({
      clientID: '80b7a03dd9cce611f9ff',
      clientSecret: 'e3296e3d54d9da61d79ee7cf072fa7a1fb5eebc2',
      repo: 'blog',
      owner: 'johnsonlee',
      admin: ['johnsonlee'],
      id: md5(location.pathname),
      distractionFreeMode: false
    })
    gitalk.render('container')
  })
})();</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://johnsonlee.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul><li><a href="/categories/biology/">Biology (1)</a><ul style="padding:revert"></ul></li><li><a href="/categories/career/">Career (10)</a><ul style="padding:revert"></ul></li><li><a href="/categories/computer-science/">Computer Science (100)</a><ul style="padding:revert"><li><a href="/categories/computer-science/architecture-design/">Architecture Design (6)</a><ul style="padding:revert"></ul></li><li><a href="/categories/computer-science/cloud/">Cloud (1)</a><ul style="padding:revert"></ul></li><li><a href="/categories/computer-science/gradle/">Gradle (4)</a><ul style="padding:revert"></ul></li><li><a href="/categories/computer-science/graphics/">Graphics (2)</a><ul style="padding:revert"></ul></li><li><a href="/categories/computer-science/java/">Java (12)</a><ul style="padding:revert"></ul></li><li><a href="/categories/computer-science/kotlin/">Kotlin (7)</a><ul style="padding:revert"></ul></li><li><a href="/categories/computer-science/mobile/">Mobile (10)</a><ul style="padding:revert"><li><a href="/categories/computer-science/mobile/android/">Android (5)</a></li><li><a href="/categories/computer-science/mobile/flutter/">Flutter (1)</a></li></ul></li><li><a href="/categories/computer-science/observability/">Observability (2)</a><ul style="padding:revert"></ul></li><li><a href="/categories/computer-science/open-source/">Open Source (56)</a><ul style="padding:revert"><li><a href="/categories/computer-science/open-source/booster/">Booster (56)</a></li></ul></li></ul></li><li><a href="/categories/diy/">DIY (1)</a><ul style="padding:revert"></ul></li><li><a href="/categories/Independent-Thinking/">Independent Thinking (10)</a><ul style="padding:revert"></ul></li><li><a href="/categories/Investment/">Investment (3)</a><ul style="padding:revert"></ul></li><li><a href="/categories/life/">Life (8)</a><ul style="padding:revert"></ul></li><li><a href="/categories/reading/">Reading (2)</a><ul style="padding:revert"></ul></li><li><a href="/categories/UI-UX/">UI/UX (1)</a><ul style="padding:revert"><li><a href="/categories/UI-UX/Design-System/">Design System (1)</a><ul style="padding:revert"></ul></li></ul></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Gradle/" style="font-size: 15px;">Gradle</a> <a href="/tags/java-gradle-plugin/" style="font-size: 15px;">java-gradle-plugin</a> <a href="/tags/JVM/" style="font-size: 15px;">JVM</a> <a href="/tags/%E7%8B%AC%E7%AB%8B%E6%80%9D%E8%80%83/" style="font-size: 15px;">独立思考</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/Build/" style="font-size: 15px;">Build</a> <a href="/tags/Compiler/" style="font-size: 15px;">Compiler</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Kotlin/" style="font-size: 15px;">Kotlin</a> <a href="/tags/ES5/" style="font-size: 15px;">ES5</a> <a href="/tags/ES6/" style="font-size: 15px;">ES6</a> <a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/Booster/" style="font-size: 15px;">Booster</a> <a href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" style="font-size: 15px;">性能优化</a> <a href="/tags/ReleaseNote/" style="font-size: 15px;">ReleaseNote</a> <a href="/tags/Stock/" style="font-size: 15px;">Stock</a> <a href="/tags/%E8%81%8C%E5%9C%BA/" style="font-size: 15px;">职场</a> <a href="/tags/UX/" style="font-size: 15px;">UX</a> <a href="/tags/Compatibility/" style="font-size: 15px;">Compatibility</a> <a href="/tags/Lambda/" style="font-size: 15px;">Lambda</a> <a href="/tags/AGP/" style="font-size: 15px;">AGP</a> <a href="/tags/Dart/" style="font-size: 15px;">Dart</a> <a href="/tags/Flutter/" style="font-size: 15px;">Flutter</a> <a href="/tags/Coupang/" style="font-size: 15px;">Coupang</a> <a href="/tags/Reveal2021/" style="font-size: 15px;">Reveal2021</a> <a href="/tags/Maven/" style="font-size: 15px;">Maven</a> <a href="/tags/Seoul/" style="font-size: 15px;">Seoul</a> <a href="/tags/Korea/" style="font-size: 15px;">Korea</a> <a href="/tags/%E9%9F%B3%E4%B9%90/" style="font-size: 15px;">音乐</a> <a href="/tags/HTML/" style="font-size: 15px;">HTML</a> <a href="/tags/Economics/" style="font-size: 15px;">Economics</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Docker/" style="font-size: 15px;">Docker</a> <a href="/tags/Thinking/" style="font-size: 15px;">Thinking</a> <a href="/tags/Android-Studio/" style="font-size: 15px;">Android Studio</a> <a href="/tags/SPI/" style="font-size: 15px;">SPI</a> <a href="/tags/MVVM/" style="font-size: 15px;">MVVM</a> <a href="/tags/JetPack/" style="font-size: 15px;">JetPack</a> <a href="/tags/%E9%A2%84%E5%8A%A0%E8%BD%BD/" style="font-size: 15px;">预加载</a> <a href="/tags/%E8%B5%9A%E9%92%B1/" style="font-size: 15px;">赚钱</a> <a href="/tags/Java-8/" style="font-size: 15px;">Java 8</a> <a href="/tags/%E7%A4%BE%E4%BC%9A/" style="font-size: 15px;">社会</a> <a href="/tags/AI/" style="font-size: 15px;">AI</a> <a href="/tags/Evolution/" style="font-size: 15px;">Evolution</a> <a href="/tags/DeepMind/" style="font-size: 15px;">DeepMind</a> <a href="/tags/AlphaFold2/" style="font-size: 15px;">AlphaFold2</a> <a href="/tags/CASP/" style="font-size: 15px;">CASP</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2025/06/23/circle-the-fed-on-chain/">Circle - 链上的美联储</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/06/22/why-i-went-all-in-on-circle/">为什么 All in CRCL?</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/06/21/no-time-to-think-from-bottom-fishing-google-tesla-to-going-all-in-on-circle/">无暇思考：从抄底 Google/Tesla 到 All in Circle</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/07/21/booster-v5-0-0-released/">Booster 5.0.0 版本发布</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/04/27/living-in-seoul-1/">Living in Seoul (1)</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/04/20/recommended-reading-thinking/">推荐阅读（思维篇）</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/01/27/use-better-metrics-for-build-performance-measurement/">洞察构建性能：选择正确的 Metrics</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/01/07/an-email-to-my-boss/">一封写给老板的邮件</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/01/01/where-the-heart-leads-the-truth-follows/">心之所向，道之所在</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/10/08/running-android-code-on-jvm/">在 JVM 上运行 Android ？！</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/johnsonlee" title="GitHub" target="_blank">GitHub</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2025 <a href="/." rel="nofollow">Johnson Lee.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-154930895-1','auto');ga('send','pageview');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = 1;
  hm.src = 'https://hm.baidu.com/hm.js?' + 'bceb83a2d24731111cbcf93ac3960952';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script><script>load('/libs/viz/2.1.2/viz.js').then(() => {
  let graphs = document.querySelectorAll('.graphviz')

  if (graphs.length > 0) {
    for (let graph of graphs) {
      let svg = undefined;
      try {
        svg = Viz(graph.textContent.replaceAll('–', '--'), 'svg');
      } catch(e) {
        svg = `<pre class="error">${e}</pre>`;
      }
      graph.outerHTML = svg;
    }
  }
});
</script><script>load('/libs/jquery/3.4.0/jquery.min.js').then(() => {
  load(
    '/js/search.js',
    '/js/share.js',
    '/js/smartresize.js',
    '/js/totop.js'
  ).then(() => {
    load('/js/codeblock-resizer.js').then(() => {});
    ('function' == typeof setupSearch) && setupSearch();
  });
});</script></div></body></html>